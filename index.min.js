!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).NanopubUtils={})}(this,(function(e){"use strict";const t=["https://grlc.nps.petapico.org/api/local/local/","https://grlc.services.np.trustyuri.net/api/local/local/","http://grlc.nanopubs.lod.labs.vu.nl/api/local/local/","http://grlc.np.dumontierlab.com/api/local/local/"],r=async(e,t)=>{if(0==t.length)return{error:"An error has occurred while checking for updates."};const n=`${t.shift()}get_latest_version?np=${e}`;try{const t=await fetch(n,{headers:{Accept:"application/json"}}),r=(await t.json()).response.results.bindings;if(1==r.length&&r[0].latest.value===e)return"This is the latest version.";if(0==r.length)return"This nanopublication has been <strong>retracted</strong>.";{const e="This nanopublication has a <strong>newer version</strong>: ";for(const t of r){const r=t.latest.value;return e+' <code><a href="'+r+'">'+r+"</a></code>"}}}catch(n){return r(e,t)}},n=e=>/.*[^A-Za-z0-9_\-](RA[A-Za-z0-9_\-]{43})/.test(e),i=e=>n(e)?e.replace(/^.*[^A-Za-z0-9_\-](RA[A-Za-z0-9_\-]{43})$/,"$1"):null,o="http://www.w3.org/1999/02/22-rdf-syntax-ns#",s="http://www.w3.org/2001/XMLSchema#",a="http://www.w3.org/2000/10/swap/";var l={xsd:{decimal:`${s}decimal`,boolean:`${s}boolean`,double:`${s}double`,integer:`${s}integer`,string:`${s}string`},rdf:{type:`${o}type`,nil:`${o}nil`,first:`${o}first`,rest:`${o}rest`,langString:`${o}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${a}reify#forSome`,forAll:`${a}reify#forAll`},log:{implies:`${a}log#implies`}},u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function h(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){if(this instanceof e){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(t,r))}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let d;var f=c("function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:u):e=>(d||(d=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0))));const{xsd:p}=l,_=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,b={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},g=/[\x00-\x20<>\\"\{\}\|\^\`]/,y={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},w=/$0^/;class m{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const e in this)!(e in y)&&this[e]instanceof RegExp&&(this[e]=w)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let r=this._input,n=r.length;for(;;){let e,s;for(;e=this._newline.exec(r);)this._comments&&(s=this._comment.exec(e[0]))&&i("comment",s[1],"",this._line,e[0].length),r=r.substr(e[0].length,r.length),n=r.length,this._line++;if(!e&&(e=this._whitespace.exec(r))&&(r=r.substr(e[0].length,r.length)),this._endOfFile.test(r))return t&&(this._comments&&(s=this._comment.exec(r))&&i("comment",s[1],"",this._line,r.length),r=null,i("eof","","",this._line,0)),this._input=r;const a=this._line,l=r[0];let u="",c="",h="",d=null,f=0,_=!1;switch(l){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(f=1,u="^");break}if(this._previousMarker="^^",r=r.substr(2),"<"!==r[0]){_=!0;break}case"<":if(d=this._unescapedIri.exec(r))u="IRI",c=d[1];else if(d=this._iri.exec(r)){if(c=this._unescape(d[1]),null===c||g.test(c))return o(this);u="IRI"}else r.length>1&&"<"===r[1]?(u="<<",f=2):this._n3Mode&&r.length>1&&"="===r[1]&&(u="inverse",f=2,c=">");break;case">":r.length>1&&">"===r[1]&&(u=">>",f=2);break;case"_":((d=this._blank.exec(r))||t&&(d=this._blank.exec(`${r} `)))&&(u="blank",h="_",c=d[1]);break;case'"':if(d=this._simpleQuotedString.exec(r))c=d[1];else if(({value:c,matchLength:f}=this._parseLiteral(r)),null===c)return o(this);null===d&&0===f||(u="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(d=this._simpleApostropheString.exec(r))c=d[1];else if(({value:c,matchLength:f}=this._parseLiteral(r)),null===c)return o(this);null===d&&0===f||(u="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(d=this._variable.exec(r))&&(u="var",c=d[0]);break;case"@":"literal"===this._previousMarker&&(d=this._langcode.exec(r))?(u="langcode",c=d[1]):(d=this._keyword.exec(r))&&(u=d[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){u=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(d=this._number.exec(r)||t&&(d=this._number.exec(`${r} `)))&&(u="literal",c=d[0],h="string"==typeof d[1]?p.double:"string"==typeof d[2]?p.decimal:p.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(d=this._sparqlKeyword.exec(r))?u=d[0].toUpperCase():_=!0;break;case"f":case"t":(d=this._boolean.exec(r))?(u="literal",c=d[0],h=p.boolean):_=!0;break;case"a":(d=this._shortPredicates.exec(r))?(u="abbreviation",c="a"):_=!0;break;case"=":this._n3Mode&&r.length>1&&(u="abbreviation",">"!==r[1]?(f=1,c="="):(f=2,c=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(f=1,u=l);break;default:_=!0}if(_&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(d=this._prefix.exec(r))?((d=this._prefixed.exec(r))||t&&(d=this._prefixed.exec(`${r} `)))&&(u="prefixed",h=d[1]||"",c=this._unescape(d[2])):(u="prefix",c=d[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?o(this):this._input=r;const b=f||d[0].length,y=i(u,c,h,a,b);this.previousToken=y,this._previousMarker=u,r=r.substr(b,r.length)}function i(t,i,o,s,a){const l=r?n-r.length:n,u={type:t,value:i,prefix:o,line:s,start:l,end:l+a};return e(null,u),u}function o(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(e){let t=!1;const r=e.replace(_,((e,r,n,i)=>{if("string"==typeof r)return String.fromCharCode(Number.parseInt(r,16));if("string"==typeof n){let e=Number.parseInt(n,16);return e<=65535?String.fromCharCode(Number.parseInt(n,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return i in b?b[i]:(t=!0,"")}));return t?null:r}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],r=t.length;let n=Math.max(this._literalClosingPos,r);for(;(n=e.indexOf(t,n))>0;){let t=0;for(;"\\"===e[n-t-1];)t++;if(t%2==0){const t=e.substring(r,n),i=t.split(/\r\n|\r|\n/).length-1,o=n+r;if(1===r&&0!==i||3===r&&this._lineMode)break;return this._line+=i,{value:this._unescape(t),matchLength:o}}n++}this._literalClosingPos=e.length-r+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const e=[];let t;if(this._tokenizeToEnd(((r,n)=>r?t=r:e.push(n)),!0),t)throw t;return e}f((()=>this._tokenizeToEnd(t,!0)))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",(e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=Buffer.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(void 0===this._input?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(t,!1)))})),e.on("end",(()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)})),e.on("error",t)}}function v(e){return!!e&&"DefaultGraph"===e.termType}const{rdf:E,xsd:S}=l;let R,x=0;const A=/^"(.*".*)(?="[^"]*$)/,I=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,j={namedNode:function(e){return new P(e)},blankNode:function(e){return new L(e||"n3-"+x++)},variable:function(e){return new O(e)},literal:function(e,t){if("string"==typeof t)return new N(`"${e}"@${t.toLowerCase()}`);let r=t?t.value:"";""===r&&("boolean"==typeof e?r=S.boolean:"number"==typeof e&&(Number.isFinite(e)?r=Number.isInteger(e)?S.integer:S.double:(r=S.double,Number.isNaN(e)||(e=e>0?"INF":"-INF"))));return""===r||r===S.string?new N(`"${e}"`):new N(`"${e}"^^${r}`)},defaultGraph:function(){return R},quad:F,triple:F};var k=j;class T{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof T?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class P extends T{get termType(){return"NamedNode"}}class N extends T{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new P(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,r=t<e.length?e[t]:"";return"^"===r?e.substr(t+2):"@"!==r?S.string:E.langString}equals(e){return e instanceof N?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class L extends T{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class O extends T{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}function M(e,t){if(t=t||j,!e)return t.defaultGraph();switch(e[0]){case"?":return t.variable(e.substr(1));case"_":return t.blankNode(e.substr(2));case'"':if(t===j)return new N(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));const r=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,r-1),"@"===e[r+1]?e.substr(r+2):t.namedNode(e.substr(r+3)));case"<":const n=I.exec(e);return t.quad(M(B(n[1]),t),M(B(n[2]),t),M(B(n[3]),t),n[4]&&M(B(n[4]),t));default:return t.namedNode(e)}}function D(e){if("string"==typeof e)return e;if(e instanceof T&&"Quad"!==e.termType)return e.id;if(!e)return R.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return`"${e.value}"${e.language?`@${e.language}`:e.datatype&&e.datatype.value!==S.string?`^^${e.datatype.value}`:""}`;case"Quad":return`<<${C(D(e.subject))} ${C(D(e.predicate))} ${C(D(e.object))}${v(e.graph)?"":` ${D(e.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${e.termType}`)}}R=new class extends T{constructor(){return super(""),R||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};class $ extends T{constructor(e,t,r,n){super(""),this._subject=e,this._predicate=t,this._object=r,this._graph=n||R}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function C(e){return e.replace(A,((e,t)=>`"${t.replace(/"/g,'""')}`))}function B(e){return e.replace(A,((e,t)=>`"${t.replace(/""/g,'"')}`))}function F(e,t,r,n){return new $(e,t,r,n)}let U=0;class W{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&q(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",r=/turtle/.test(t),n=/trig/.test(t),i=/triple/.test(t),o=/quad/.test(t),s=this._n3Mode=/n3/.test(t),a=i||o;(this._supportsNamedGraphs=!(r||s))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||n||i||s),this._supportsRDFStar=""===t||/star|\*$/.test(t),a&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new m({lineMode:a,n3:s}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){U=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,r,n,i){const o=this._n3Mode;this._contextStack.push({type:e,subject:r,predicate:n,object:i,graph:t,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const r=this._contextStack.pop();if(!r||r.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=r.subject,this._predicate=r.predicate,this._object=r.object,this._graph=r.graph,this._n3Mode&&(this._inversePredicate=r.inverse,this._prefixes._=r.blankPrefix,this._quantified=r.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let r;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);r=this._namedNode(t);break;case"type":case"prefixed":const n=this._prefixes[e.prefix];if(void 0===n)return this._error(`Undefined prefix "${e.prefix}:"`,e);r=this._namedNode(n+e.value);break;case"blank":r=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":r=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,r=null,n=this._readListItem;const i=this._subject,o=this._contextStack,s=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,r=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),n=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==o.length&&"list"===o[o.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(n=this._readPredicate,this._subject===this.RDF_NIL)return n}else if(n=this._getContextEndReader(),this._object===this.RDF_NIL)return n;r=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,n=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),n=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===r&&(this._subject=r=this._blankNode()),null===i?null===s.predicate?s.subject=r:s.object=r:this._emit(i,this.RDF_REST,r,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,r,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,t,this._graph)}return n}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const r=this._readEntity(e);if(void 0===r)return;t=this._literal(this._literalValue,r),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const r=this._completeLiteral(e);if(r)return this._object=r.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===r.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(r.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,r=this._graph;const n=this._subject,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==n){const e=this._predicate,t=this._object;i?this._emit(t,e,n,r):this._emit(n,e,t,r)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,r=t.length&&t[t.length-1];if(r&&"item"===r.type){const t=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,t,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,r;const n=this._blankNode();if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._emit(t,r,n,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let r,n;if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(n=this._subject,this._subject=t):(n=this._object,this._object=t),this._emit(t,r,n,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,r,n){this._callback(null,this._quad(e,t,r,n||this.DEFAULTGRAPH))}_error(e,t){const r=new Error(`${e} on line ${t.line}.`);r.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=G}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let r="",n=-1,i=-1,o=0,s="/";for(;n<t;){switch(s){case":":if(i<0&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<t&&"/"!==e[i];)n=i;break;case"?":case"#":n=t;break;case"/":if("."===e[n+1])switch(s=e[1+ ++n],s){case"/":r+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return r+e.substring(o,n)+e.substr(n+1);case".":if(s=e[1+ ++n],void 0===s||"/"===s||"?"===s||"#"===s){if(r+=e.substring(o,n-2),(o=r.lastIndexOf("/"))>=i&&(r=r.substr(0,o)),"/"!==s)return`${r}/${e.substr(n+1)}`;o=n+1}}}s=e[++n]}return r+e.substring(o)}parse(e,t,r){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${U++}_`,this._prefixCallback=r||G,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const t=[];let r;if(this._callback=(e,n)=>{e?r=e:n&&t.push(n)},this._lexer.tokenize(e).every((e=>this._readCallback=this._readCallback(e))),r)throw r;return t}this._callback=t,this._lexer.tokenize(e,((e,t)=>{null!==e?(this._callback(e),this._callback=G):this._readCallback&&(this._readCallback=this._readCallback(t))}))}}function G(){}function q(e,t){const r=t.namedNode;e._namedNode=r,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=r(l.rdf.first),e.RDF_REST=r(l.rdf.rest),e.RDF_NIL=r(l.rdf.nil),e.N3_FORALL=r(l.r.forAll),e.N3_FORSOME=r(l.r.forSome),e.ABBREVIATIONS={a:r(l.rdf.type),"=":r(l.owl.sameAs),">":r(l.log.implies)},e.QUANTIFIERS_GRAPH=r("urn:n3:quantifiers")}q(W.prototype,k);const z=k.defaultGraph(),{rdf:Q,xsd:Y}=l,H=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,V=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,K={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class Z extends T{equals(){return!1}}class J{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},this._lists=t.lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,r,n){e+=t,n&&n()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=z,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),t.baseIRI&&(this._baseMatcher=new RegExp(`^${ee(t.baseIRI)}${t.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=t.baseIRI.length))}get _inDefaultGraph(){return z.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,r,n,i){try{n.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(z.equals(n)?"":`${this._encodeIriOrBlank(n)} {\n`)),this._graph=n,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(r)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(r)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(r)}`,i)}catch(e){i&&i(e)}}_writeQuadLine(e,t,r,n,i){delete this._prefixMatch,this._write(this.quadToString(e,t,r,n),i)}quadToString(e,t,r,n){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(r)}${n&&n.value?` ${this._encodeIriOrBlank(n)} .\n`:" .\n"}`}quadsToString(e){return e.map((e=>this.quadToString(e.subject,e.predicate,e.object,e.graph))).join("")}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseMatcher&&this._baseMatcher.test(t)&&(t=t.substr(this._baseLength)),H.test(t)&&(t=t.replace(V,X));const r=this._prefixRegex.exec(t);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(H.test(t)&&(t=t.replace(V,X)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===Y.string)return`"${t}"`}else switch(e.datatype.value){case Y.string:return`"${t}"`;case Y.boolean:if("true"===t||"false"===t)return t;break;case Y.integer:if(/^[+-]?\d+$/.test(t))return t;break;case Y.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case Y.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===Q.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:r,graph:n}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(r)}${v(n)?"":` ${this._encodeIriOrBlank(n)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,r,n,i){void 0===r?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof n?this._writeQuad(e,t,r,z,n):this._writeQuad(e,t,r,n||z,i)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,r){const n={};n[e]=t,this.addPrefixes(n,r)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let r=!1;for(let t in e){let n=e[t];"string"!=typeof n&&(n=n.value),r=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[n]=t+=":",this._write(`@prefix ${t} <${n}>.\n`)}if(r){let e="",t="";for(const r in this._prefixIRIs)e+=e?`|${r}`:r,t+=(t?"|":"")+this._prefixIRIs[r];e=ee(e),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([_a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(r?"\n":"",t)}blank(e,t){let r,n,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return new Z("[]");case 1:if(r=i[0],!(r.object instanceof Z))return new Z(`[ ${this._encodePredicate(r.predicate)} ${this._encodeObject(r.object)} ]`);default:let t="[";for(let o=0;o<n;o++)r=i[o],r.predicate.equals(e)?t+=`, ${this._encodeObject(r.object)}`:(t+=`${(o?";\n  ":"\n  ")+this._encodePredicate(r.predicate)} ${this._encodeObject(r.object)}`,e=r.predicate);return new Z(`${t}\n]`)}}list(e){const t=e&&e.length||0,r=new Array(t);for(let n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return new Z(`(${r.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((r,n)=>{t=null,e(r,n)});if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}}function X(e){let t=K[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function ee(e){return e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var te={exports:{}},re={exports:{}},ne="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},ie=[],oe=[],se="undefined"!=typeof Uint8Array?Uint8Array:Array,ae=!1;function le(){ae=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)ie[t]=e[t],oe[e.charCodeAt(t)]=t;oe["-".charCodeAt(0)]=62,oe["_".charCodeAt(0)]=63}function ue(e,t,r){for(var n,i,o=[],s=t;s<r;s+=3)n=(e[s]<<16)+(e[s+1]<<8)+e[s+2],o.push(ie[(i=n)>>18&63]+ie[i>>12&63]+ie[i>>6&63]+ie[63&i]);return o.join("")}function ce(e){var t;ae||le();for(var r=e.length,n=r%3,i="",o=[],s=16383,a=0,l=r-n;a<l;a+=s)o.push(ue(e,a,a+s>l?l:a+s));return 1===n?(t=e[r-1],i+=ie[t>>2],i+=ie[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=ie[t>>10],i+=ie[t>>4&63],i+=ie[t<<2&63],i+="="),o.push(i),o.join("")}function he(e,t,r,n,i){var o,s,a=8*i-n-1,l=(1<<a)-1,u=l>>1,c=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+e[t+h],h+=d,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+e[t+h],h+=d,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)}function de(e,t,r,n,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(t*l-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+f]=255&s,f+=p,s/=256,u-=8);e[r+f-p]|=128*_}var fe={}.toString,pe=Array.isArray||function(e){return"[object Array]"==fe.call(e)};ye.TYPED_ARRAY_SUPPORT=void 0===ne.TYPED_ARRAY_SUPPORT||ne.TYPED_ARRAY_SUPPORT;var _e=be();function be(){return ye.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ge(e,t){if(be()<t)throw new RangeError("Invalid typed array length");return ye.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=ye.prototype:(null===e&&(e=new ye(t)),e.length=t),e}function ye(e,t,r){if(!(ye.TYPED_ARRAY_SUPPORT||this instanceof ye))return new ye(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return ve(this,e)}return we(this,e,t,r)}function we(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);ye.TYPED_ARRAY_SUPPORT?(e=t).__proto__=ye.prototype:e=Ee(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!ye.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|xe(t,r);e=ge(e,n);var i=e.write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(Re(t)){var r=0|Se(t.length);return 0===(e=ge(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?ge(e,0):Ee(e,t);if("Buffer"===t.type&&pe(t.data))return Ee(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function me(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function ve(e,t){if(me(t),e=ge(e,t<0?0:0|Se(t)),!ye.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function Ee(e,t){var r=t.length<0?0:0|Se(t.length);e=ge(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function Se(e){if(e>=be())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+be().toString(16)+" bytes");return 0|e}function Re(e){return!(null==e||!e._isBuffer)}function xe(e,t){if(Re(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Je(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Xe(e).length;default:if(n)return Je(e).length;t=(""+t).toLowerCase(),n=!0}}function Ae(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Ue(this,t,r);case"utf8":case"utf-8":return $e(this,t,r);case"ascii":return Be(this,t,r);case"latin1":case"binary":return Fe(this,t,r);case"base64":return De(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return We(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function Ie(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function je(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=ye.from(t,n)),Re(t))return 0===t.length?-1:ke(e,t,r,n,i);if("number"==typeof t)return t&=255,ye.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):ke(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function ke(e,t,r,n,i){var o,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(u(e,o+d)!==u(t,d)){h=!1;break}if(h)return o}return-1}function Te(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function Pe(e,t,r,n){return et(Je(t,e.length-r),e,r,n)}function Ne(e,t,r,n){return et(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function Le(e,t,r,n){return Ne(e,t,r,n)}function Oe(e,t,r,n){return et(Xe(t),e,r,n)}function Me(e,t,r,n){return et(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function De(e,t,r){return 0===t&&r===e.length?ce(e):ce(e.slice(t,r))}function $e(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,l,u=e[i],c=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(l=(15&u)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(e){var t=e.length;if(t<=Ce)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Ce));return r}(n)}ye.poolSize=8192,ye._augment=function(e){return e.__proto__=ye.prototype,e},ye.from=function(e,t,r){return we(null,e,t,r)},ye.TYPED_ARRAY_SUPPORT&&(ye.prototype.__proto__=Uint8Array.prototype,ye.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&ye[Symbol.species]),ye.alloc=function(e,t,r){return function(e,t,r,n){return me(t),t<=0?ge(e,t):void 0!==r?"string"==typeof n?ge(e,t).fill(r,n):ge(e,t).fill(r):ge(e,t)}(null,e,t,r)},ye.allocUnsafe=function(e){return ve(null,e)},ye.allocUnsafeSlow=function(e){return ve(null,e)},ye.isBuffer=tt,ye.compare=function(e,t){if(!Re(e)||!Re(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},ye.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ye.concat=function(e,t){if(!pe(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return ye.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=ye.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!Re(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},ye.byteLength=xe,ye.prototype._isBuffer=!0,ye.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Ie(this,t,t+1);return this},ye.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Ie(this,t,t+3),Ie(this,t+1,t+2);return this},ye.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Ie(this,t,t+7),Ie(this,t+1,t+6),Ie(this,t+2,t+5),Ie(this,t+3,t+4);return this},ye.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?$e(this,0,e):Ae.apply(this,arguments)},ye.prototype.equals=function(e){if(!Re(e))throw new TypeError("Argument must be a Buffer");return this===e||0===ye.compare(this,e)},ye.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},ye.prototype.compare=function(e,t,r,n,i){if(!Re(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(n,i),u=e.slice(t,r),c=0;c<a;++c)if(l[c]!==u[c]){o=l[c],s=u[c];break}return o<s?-1:s<o?1:0},ye.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},ye.prototype.indexOf=function(e,t,r){return je(this,e,t,r,!0)},ye.prototype.lastIndexOf=function(e,t,r){return je(this,e,t,r,!1)},ye.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return Te(this,e,t,r);case"utf8":case"utf-8":return Pe(this,e,t,r);case"ascii":return Ne(this,e,t,r);case"latin1":case"binary":return Le(this,e,t,r);case"base64":return Oe(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},ye.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ce=4096;function Be(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function Fe(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function Ue(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=Ze(e[o]);return i}function We(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function Ge(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function qe(e,t,r,n,i,o){if(!Re(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function ze(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Qe(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function Ye(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function He(e,t,r,n,i){return i||Ye(e,0,r,4),de(e,t,r,n,23,4),r+4}function Ve(e,t,r,n,i){return i||Ye(e,0,r,8),de(e,t,r,n,52,8),r+8}ye.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),ye.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=ye.prototype;else{var i=t-e;r=new ye(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},ye.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||Ge(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},ye.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||Ge(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},ye.prototype.readUInt8=function(e,t){return t||Ge(e,1,this.length),this[e]},ye.prototype.readUInt16LE=function(e,t){return t||Ge(e,2,this.length),this[e]|this[e+1]<<8},ye.prototype.readUInt16BE=function(e,t){return t||Ge(e,2,this.length),this[e]<<8|this[e+1]},ye.prototype.readUInt32LE=function(e,t){return t||Ge(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},ye.prototype.readUInt32BE=function(e,t){return t||Ge(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},ye.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||Ge(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},ye.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||Ge(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},ye.prototype.readInt8=function(e,t){return t||Ge(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},ye.prototype.readInt16LE=function(e,t){t||Ge(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},ye.prototype.readInt16BE=function(e,t){t||Ge(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},ye.prototype.readInt32LE=function(e,t){return t||Ge(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},ye.prototype.readInt32BE=function(e,t){return t||Ge(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},ye.prototype.readFloatLE=function(e,t){return t||Ge(e,4,this.length),he(this,e,!0,23,4)},ye.prototype.readFloatBE=function(e,t){return t||Ge(e,4,this.length),he(this,e,!1,23,4)},ye.prototype.readDoubleLE=function(e,t){return t||Ge(e,8,this.length),he(this,e,!0,52,8)},ye.prototype.readDoubleBE=function(e,t){return t||Ge(e,8,this.length),he(this,e,!1,52,8)},ye.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||qe(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},ye.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||qe(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},ye.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,1,255,0),ye.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},ye.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,2,65535,0),ye.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):ze(this,e,t,!0),t+2},ye.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,2,65535,0),ye.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):ze(this,e,t,!1),t+2},ye.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,4,4294967295,0),ye.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Qe(this,e,t,!0),t+4},ye.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,4,4294967295,0),ye.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Qe(this,e,t,!1),t+4},ye.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);qe(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},ye.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);qe(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},ye.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,1,127,-128),ye.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},ye.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,2,32767,-32768),ye.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):ze(this,e,t,!0),t+2},ye.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,2,32767,-32768),ye.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):ze(this,e,t,!1),t+2},ye.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,4,2147483647,-2147483648),ye.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Qe(this,e,t,!0),t+4},ye.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||qe(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),ye.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Qe(this,e,t,!1),t+4},ye.prototype.writeFloatLE=function(e,t,r){return He(this,e,t,!0,r)},ye.prototype.writeFloatBE=function(e,t,r){return He(this,e,t,!1,r)},ye.prototype.writeDoubleLE=function(e,t,r){return Ve(this,e,t,!0,r)},ye.prototype.writeDoubleBE=function(e,t,r){return Ve(this,e,t,!1,r)},ye.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!ye.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},ye.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!ye.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=Re(e)?e:Je(new ye(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var Ke=/[^+\/0-9A-Za-z-_]/g;function Ze(e){return e<16?"0"+e.toString(16):e.toString(16)}function Je(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Xe(e){return function(e){var t,r,n,i,o,s;ae||le();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,s=new se(3*a/4-o),n=o>0?a-4:a;var l=0;for(t=0,r=0;t<n;t+=4,r+=3)i=oe[e.charCodeAt(t)]<<18|oe[e.charCodeAt(t+1)]<<12|oe[e.charCodeAt(t+2)]<<6|oe[e.charCodeAt(t+3)],s[l++]=i>>16&255,s[l++]=i>>8&255,s[l++]=255&i;return 2===o?(i=oe[e.charCodeAt(t)]<<2|oe[e.charCodeAt(t+1)]>>4,s[l++]=255&i):1===o&&(i=oe[e.charCodeAt(t)]<<10|oe[e.charCodeAt(t+1)]<<4|oe[e.charCodeAt(t+2)]>>2,s[l++]=i>>8&255,s[l++]=255&i),s}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Ke,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function et(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function tt(e){return null!=e&&(!!e._isBuffer||rt(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&rt(e.slice(0,0))}(e))}function rt(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var nt=h(Object.freeze({__proto__:null,Buffer:ye,INSPECT_MAX_BYTES:50,SlowBuffer:function(e){return+e!=e&&(e=0),ye.alloc(+e)},isBuffer:tt,kMaxLength:_e})),it={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error:Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise:Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String:String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol:Symbol,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Uint8Array:Uint8Array},ot={exports:{}};!function(e){const t=nt,r=Object.getPrototypeOf((async function(){})).constructor,n=globalThis.Blob||t.Blob,i=void 0!==n?function(e){return e instanceof n}:function(e){return!1};class o extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:o,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}},promisify:e=>new Promise(((t,r)=>{e(((e,...n)=>e?r(e):t(...n)))})),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,(function(...[e,r]){const n=t.shift();if("f"===r)return n.toFixed(6);if("j"===r)return JSON.stringify(n);if("s"===r&&"object"==typeof n){return`${n.constructor!==Object?n.constructor.name:""} {}`.trim()}return n.toString()})),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof r,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:i},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(ot);var st,at=ot.exports,lt={},ut={exports:{}};function ct(){if(st)return ut.exports;st=1;const{AbortController:e,AbortSignal:t}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;return ut.exports=e,ut.exports.AbortSignal=t,ut.exports.default=e,ut.exports}const{format:ht,inspect:dt,AggregateError:ft}=at,pt=globalThis.AggregateError||ft,_t=Symbol("kIsNodeError"),bt=["string","function","number","object","Function","Object","boolean","bigint","symbol"],gt=/^([A-Z][a-z0-9]*)+$/,yt={};function wt(e,t){if(!e)throw new yt.ERR_INTERNAL_ASSERTION(t)}function mt(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function vt(e,t,r){r||(r=Error);class n extends r{constructor(...r){super(function(e,t,r){if("function"==typeof t)return wt(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);const n=(t.match(/%[dfijoOs]/g)||[]).length;return wt(n===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),0===r.length?t:ht(t,...r)}(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[_t]=!0,yt[e]=n}function Et(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}let St=class extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new yt.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};vt("ERR_ASSERTION","%s",Error),vt("ERR_INVALID_ARG_TYPE",((e,t,r)=>{wt("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+=`${e} `:n+=`"${e}" ${e.includes(".")?"property":"argument"} `,n+="must be ";const i=[],o=[],s=[];for(const e of t)wt("string"==typeof e,"All expected entries have to be of type string"),bt.includes(e)?i.push(e.toLowerCase()):gt.test(e)?o.push(e):(wt("object"!==e,'The value "object" should be written as "Object"'),s.push(e));if(o.length>0){const e=i.indexOf("object");-1!==e&&(i.splice(i,e,1),o.push("Object"))}if(i.length>0){switch(i.length){case 1:n+=`of type ${i[0]}`;break;case 2:n+=`one of type ${i[0]} or ${i[1]}`;break;default:{const e=i.pop();n+=`one of type ${i.join(", ")}, or ${e}`}}(o.length>0||s.length>0)&&(n+=" or ")}if(o.length>0){switch(o.length){case 1:n+=`an instance of ${o[0]}`;break;case 2:n+=`an instance of ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();n+=`an instance of ${o.join(", ")}, or ${e}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();n+=`one of ${s.join(", ")}, or ${e}`}}if(null==r)n+=`. Received ${r}`;else if("function"==typeof r&&r.name)n+=`. Received function ${r.name}`;else if("object"==typeof r){var a;if(null!==(a=r.constructor)&&void 0!==a&&a.name)n+=`. Received an instance of ${r.constructor.name}`;else{n+=`. Received ${dt(r,{depth:-1})}`}}else{let e=dt(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),n+=`. Received type ${typeof r} (${e})`}return n}),TypeError),vt("ERR_INVALID_ARG_VALUE",((e,t,r="is invalid")=>{let n=dt(t);n.length>128&&(n=n.slice(0,128)+"...");return`The ${e.includes(".")?"property":"argument"} '${e}' ${r}. Received ${n}`}),TypeError),vt("ERR_INVALID_RETURN_VALUE",((e,t,r)=>{var n;return`Expected ${e} to be returned from the "${t}" function but got ${null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:"type "+typeof r}.`}),TypeError),vt("ERR_MISSING_ARGS",((...e)=>{let t;wt(e.length>0,"At least one arg needs to be specified");const r=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`}),TypeError),vt("ERR_OUT_OF_RANGE",((e,t,r)=>{let n;return wt(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>2**32?n=mt(String(r)):"bigint"==typeof r?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=mt(n)),n+="n"):n=dt(r),`The value of "${e}" is out of range. It must be ${t}. Received ${n}`}),RangeError),vt("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),vt("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),vt("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),vt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),vt("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),vt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),vt("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),vt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),vt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),vt("ERR_STREAM_WRITE_AFTER_END","write after end",Error),vt("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var Rt={AbortError:St,aggregateTwoErrors:Et((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const r=new pt([t,e],t.message);return r.code=t.code,r}return e||t})),hideStackFrames:Et,codes:yt};const{ArrayIsArray:xt,ArrayPrototypeIncludes:At,ArrayPrototypeJoin:It,ArrayPrototypeMap:jt,NumberIsInteger:kt,NumberIsNaN:Tt,NumberMAX_SAFE_INTEGER:Pt,NumberMIN_SAFE_INTEGER:Nt,NumberParseInt:Lt,ObjectPrototypeHasOwnProperty:Ot,RegExpPrototypeExec:Mt,String:Dt,StringPrototypeToUpperCase:$t,StringPrototypeTrim:Ct}=it,{hideStackFrames:Bt,codes:{ERR_SOCKET_BAD_PORT:Ft,ERR_INVALID_ARG_TYPE:Ut,ERR_INVALID_ARG_VALUE:Wt,ERR_OUT_OF_RANGE:Gt,ERR_UNKNOWN_SIGNAL:qt}}=Rt,{normalizeEncoding:zt}=at,{isAsyncFunction:Qt,isArrayBufferView:Yt}=at.types,Ht={};const Vt=/^[0-7]+$/;const Kt=Bt(((e,t,r=Nt,n=Pt)=>{if("number"!=typeof e)throw new Ut(t,"number",e);if(!kt(e))throw new Gt(t,"an integer",e);if(e<r||e>n)throw new Gt(t,`>= ${r} && <= ${n}`,e)})),Zt=Bt(((e,t,r=-2147483648,n=2147483647)=>{if("number"!=typeof e)throw new Ut(t,"number",e);if(!kt(e))throw new Gt(t,"an integer",e);if(e<r||e>n)throw new Gt(t,`>= ${r} && <= ${n}`,e)})),Jt=Bt(((e,t,r=!1)=>{if("number"!=typeof e)throw new Ut(t,"number",e);if(!kt(e))throw new Gt(t,"an integer",e);const n=r?1:0,i=4294967295;if(e<n||e>i)throw new Gt(t,`>= ${n} && <= ${i}`,e)}));function Xt(e,t){if("string"!=typeof e)throw new Ut(t,"string",e)}const er=Bt(((e,t,r)=>{if(!At(r,e)){const n=It(jt(r,(e=>"string"==typeof e?`'${e}'`:Dt(e))),", ");throw new Wt(t,e,"must be one of: "+n)}}));function tr(e,t,r){return null!=e&&Ot(e,t)?e[t]:r}const rr=Bt(((e,t,r=null)=>{const n=tr(r,"allowArray",!1),i=tr(r,"allowFunction",!1);if(!tr(r,"nullable",!1)&&null===e||!n&&xt(e)||"object"!=typeof e&&(!i||"function"!=typeof e))throw new Ut(t,"Object",e)})),nr=Bt(((e,t,r=0)=>{if(!xt(e))throw new Ut(t,"Array",e);if(e.length<r){throw new Wt(t,e,`must be longer than ${r}`)}}));const ir=Bt(((e,t="buffer")=>{if(!Yt(e))throw new Ut(t,["Buffer","TypedArray","DataView"],e)}));const or=Bt(((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new Ut(t,"AbortSignal",e)})),sr=Bt(((e,t)=>{if("function"!=typeof e)throw new Ut(t,"Function",e)})),ar=Bt(((e,t)=>{if("function"!=typeof e||Qt(e))throw new Ut(t,"Function",e)})),lr=Bt(((e,t)=>{if(void 0!==e)throw new Ut(t,"undefined",e)}));var ur={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===Mt(Vt,e))throw new Wt(t,e,"must be a 32-bit unsigned integer or an octal string");e=Lt(e,8)}return Jt(e,t),e},validateArray:nr,validateBoolean:function(e,t){if("boolean"!=typeof e)throw new Ut(t,"boolean",e)},validateBuffer:ir,validateEncoding:function(e,t){const r=zt(t),n=e.length;if("hex"===r&&n%2!=0)throw new Wt("encoding",t,`is invalid for data of length ${n}`)},validateFunction:sr,validateInt32:Zt,validateInteger:Kt,validateNumber:function(e,t,r=void 0,n){if("number"!=typeof e)throw new Ut(t,"number",e);if(null!=r&&e<r||null!=n&&e>n||(null!=r||null!=n)&&Tt(e))throw new Gt(t,`${null!=r?`>= ${r}`:""}${null!=r&&null!=n?" && ":""}${null!=n?`<= ${n}`:""}`,e)},validateObject:rr,validateOneOf:er,validatePlainFunction:ar,validatePort:function(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===Ct(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new Ft(t,e,r);return 0|e},validateSignalName:function(e,t="signal"){if(Xt(e,t),void 0===Ht[e]){if(void 0!==Ht[$t(e)])throw new qt(e+" (signals must use all capital letters)");throw new qt(e)}},validateString:Xt,validateUint32:Jt,validateUndefined:lr,validateUnion:function(e,t,r){if(!At(r,e))throw new Ut(t,`('${It(r,"|")}')`,e)},validateAbortSignal:or},cr={exports:{}};function hr(){throw new Error("setTimeout has not been defined")}function dr(){throw new Error("clearTimeout has not been defined")}var fr=hr,pr=dr;function _r(e){if(fr===setTimeout)return setTimeout(e,0);if((fr===hr||!fr)&&setTimeout)return fr=setTimeout,setTimeout(e,0);try{return fr(e,0)}catch(t){try{return fr.call(null,e,0)}catch(t){return fr.call(this,e,0)}}}"function"==typeof ne.setTimeout&&(fr=setTimeout),"function"==typeof ne.clearTimeout&&(pr=clearTimeout);var br,gr=[],yr=!1,wr=-1;function mr(){yr&&br&&(yr=!1,br.length?gr=br.concat(gr):wr=-1,gr.length&&vr())}function vr(){if(!yr){var e=_r(mr);yr=!0;for(var t=gr.length;t;){for(br=gr,gr=[];++wr<t;)br&&br[wr].run();wr=-1,t=gr.length}br=null,yr=!1,function(e){if(pr===clearTimeout)return clearTimeout(e);if((pr===dr||!pr)&&clearTimeout)return pr=clearTimeout,clearTimeout(e);try{return pr(e)}catch(t){try{return pr.call(null,e)}catch(t){return pr.call(this,e)}}}(e)}}function Er(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];gr.push(new Sr(e,t)),1!==gr.length||yr||_r(vr)}function Sr(e,t){this.fun=e,this.array=t}Sr.prototype.run=function(){this.fun.apply(null,this.array)};var Rr="browser",xr="browser",Ar={},Ir=[],jr={},kr={},Tr={};function Pr(){}var Nr=Pr,Lr=Pr,Or=Pr,Mr=Pr,Dr=Pr,$r=Pr,Cr=Pr;function Br(e){throw new Error("process.binding is not supported")}function Fr(){return"/"}function Ur(e){throw new Error("process.chdir is not supported")}function Wr(){return 0}var Gr=ne.performance||{},qr=Gr.now||Gr.mozNow||Gr.msNow||Gr.oNow||Gr.webkitNow||function(){return(new Date).getTime()};function zr(e){var t=.001*qr.call(Gr),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]}var Qr=new Date;function Yr(){return(new Date-Qr)/1e3}var Hr={nextTick:Er,title:Rr,browser:true,env:Ar,argv:Ir,version:"",versions:jr,on:Nr,addListener:Lr,once:Or,off:Mr,removeListener:Dr,removeAllListeners:$r,emit:Cr,binding:Br,cwd:Fr,chdir:Ur,umask:Wr,hrtime:zr,platform:xr,release:kr,config:Tr,uptime:Yr},Vr=h(Object.freeze({__proto__:null,addListener:Lr,argv:Ir,binding:Br,browser:true,chdir:Ur,config:Tr,cwd:Fr,default:Hr,emit:Cr,env:Ar,hrtime:zr,nextTick:Er,off:Mr,on:Nr,once:Or,platform:xr,release:kr,removeAllListeners:$r,removeListener:Dr,title:Rr,umask:Wr,uptime:Yr,version:"",versions:jr}));const{Symbol:Kr,SymbolAsyncIterator:Zr,SymbolIterator:Jr}=it,Xr=Kr("kDestroyed"),en=Kr("kIsErrored"),tn=Kr("kIsReadable"),rn=Kr("kIsDisturbed");function nn(e,t=!1){var r;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(r=e._readableState)||void 0===r?void 0:r.readable)||e._writableState&&!e._readableState)}function on(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function sn(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function an(e){if(!sn(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[Xr]||null!=n&&n.destroyed)}function ln(e){if(!on(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function un(e,t){if(!nn(e))return null;const r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function cn(e){return e&&null!=e[tn]?e[tn]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!an(e)&&(nn(e)&&e.readable&&!un(e))}function hn(e){return"boolean"!=typeof(null==e?void 0:e.writable)?null:!an(e)&&(on(e)&&e.writable&&!ln(e))}function dn(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function fn(e){return"boolean"==typeof e._sent100&&dn(e)}var pn={kDestroyed:Xr,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[rn])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:rn,isErrored:function(e){var t,r,n,i,o,s,a,l,u,c;return!(!e||!(null!==(t=null!==(r=null!==(n=null!==(i=null!==(o=null!==(s=e[en])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(a=e._readableState)||void 0===a?void 0:a.errorEmitted)&&void 0!==n?n:null===(l=e._writableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(c=e._writableState)||void 0===c?void 0:c.errored))},kIsErrored:en,isReadable:cn,kIsReadable:tn,isClosed:function(e){if(!sn(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&dn(e)?e._closed:null},isDestroyed:an,isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return sn(e)?!!an(e)||(!1===(null==t?void 0:t.readable)||!cn(e))&&(!1===(null==t?void 0:t.writable)||!hn(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[Zr]:!1===t?"function"==typeof e[Jr]:"function"==typeof e[Zr]||"function"==typeof e[Jr])},isReadableNodeStream:nn,isReadableEnded:function(e){if(!nn(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:un,isReadableErrored:function(e){var t,r;return sn(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream:sn,isWritable:hn,isWritableNodeStream:on,isWritableEnded:ln,isWritableFinished:function(e,t){if(!on(e))return null;if(!0===e.writableFinished)return!0;const r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return sn(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:fn,willEmitClose:function(e){if(!sn(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!n&&fn(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)}};const _n=Vr,{AbortError:bn,codes:gn}=Rt,{ERR_INVALID_ARG_TYPE:yn,ERR_STREAM_PREMATURE_CLOSE:wn}=gn,{kEmptyObject:mn,once:vn}=at,{validateAbortSignal:En,validateFunction:Sn,validateObject:Rn}=ur,{Promise:xn}=it,{isClosed:An,isReadable:In,isReadableNodeStream:jn,isReadableFinished:kn,isReadableErrored:Tn,isWritable:Pn,isWritableNodeStream:Nn,isWritableFinished:Ln,isWritableErrored:On,isNodeStream:Mn,willEmitClose:Dn}=pn;const $n=()=>{};function Cn(e,t,r){var n,i;2===arguments.length?(r=t,t=mn):null==t?t=mn:Rn(t,"options"),Sn(r,"callback"),En(t.signal,"options.signal"),r=vn(r);const o=null!==(n=t.readable)&&void 0!==n?n:jn(e),s=null!==(i=t.writable)&&void 0!==i?i:Nn(e);if(!Mn(e))throw new yn("stream","Stream",e);const a=e._writableState,l=e._readableState,u=()=>{e.writable||d()};let c=Dn(e)&&jn(e)===o&&Nn(e)===s,h=Ln(e,!1);const d=()=>{h=!0,e.destroyed&&(c=!1),(!c||e.readable&&!o)&&(o&&!f||r.call(e))};let f=kn(e,!1);const p=()=>{f=!0,e.destroyed&&(c=!1),(!c||e.writable&&!s)&&(s&&!h||r.call(e))},_=t=>{r.call(e,t)};let b=An(e);const g=()=>{b=!0;const t=On(e)||Tn(e);return t&&"boolean"!=typeof t?r.call(e,t):o&&!f&&jn(e,!0)&&!kn(e,!1)?r.call(e,new wn):!s||h||Ln(e,!1)?void r.call(e):r.call(e,new wn)},y=()=>{e.req.on("finish",d)};!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?s&&!a&&(e.on("end",u),e.on("close",u)):(e.on("complete",d),c||e.on("abort",g),e.req?y():e.on("request",y)),c||"boolean"!=typeof e.aborted||e.on("aborted",g),e.on("end",p),e.on("finish",d),!1!==t.error&&e.on("error",_),e.on("close",g),b?_n.nextTick(g):null!=a&&a.errorEmitted||null!=l&&l.errorEmitted?c||_n.nextTick(g):(o||c&&!In(e)||!h&&!1!==Pn(e))&&(s||c&&!Pn(e)||!f&&!1!==In(e))?l&&e.req&&e.aborted&&_n.nextTick(g):_n.nextTick(g);const w=()=>{r=$n,e.removeListener("aborted",g),e.removeListener("complete",d),e.removeListener("abort",g),e.removeListener("request",y),e.req&&e.req.removeListener("finish",d),e.removeListener("end",u),e.removeListener("close",u),e.removeListener("finish",d),e.removeListener("end",p),e.removeListener("error",_),e.removeListener("close",g)};if(t.signal&&!b){const n=()=>{const n=r;w(),n.call(e,new bn(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)_n.nextTick(n);else{const i=r;r=vn(((...r)=>{t.signal.removeEventListener("abort",n),i.apply(e,r)})),t.signal.addEventListener("abort",n)}}return w}cr.exports=Cn,cr.exports.finished=function(e,t){return new xn(((r,n)=>{Cn(e,t,(e=>{e?n(e):r()}))}))};var Bn=cr.exports;const Fn=globalThis.AbortController||ct().AbortController,{codes:{ERR_INVALID_ARG_TYPE:Un,ERR_MISSING_ARGS:Wn,ERR_OUT_OF_RANGE:Gn},AbortError:qn}=Rt,{validateAbortSignal:zn,validateInteger:Qn,validateObject:Yn}=ur,Hn=it.Symbol("kWeak"),{finished:Vn}=Bn,{ArrayPrototypePush:Kn,MathFloor:Zn,Number:Jn,NumberIsNaN:Xn,Promise:ei,PromiseReject:ti,PromisePrototypeThen:ri,Symbol:ni}=it,ii=ni("kEmpty"),oi=ni("kEof");function si(e,t){if("function"!=typeof e)throw new Un("fn",["Function","AsyncFunction"],e);null!=t&&Yn(t,"options"),null!=(null==t?void 0:t.signal)&&zn(t.signal,"options.signal");let r=1;return null!=(null==t?void 0:t.concurrency)&&(r=Zn(t.concurrency)),Qn(r,"concurrency",1),async function*(){var n,i;const o=new Fn,s=this,a=[],l=o.signal,u={signal:l},c=()=>o.abort();let h,d;null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted&&c(),null==t||null===(i=t.signal)||void 0===i||i.addEventListener("abort",c);let f=!1;function p(){f=!0}!async function(){try{for await(let t of s){var n;if(f)return;if(l.aborted)throw new qn;try{t=e(t,u)}catch(e){t=ti(e)}t!==ii&&("function"==typeof(null===(n=t)||void 0===n?void 0:n.catch)&&t.catch(p),a.push(t),h&&(h(),h=null),!f&&a.length&&a.length>=r&&await new ei((e=>{d=e})))}a.push(oi)}catch(e){const t=ti(e);ri(t,void 0,p),a.push(t)}finally{var i;f=!0,h&&(h(),h=null),null==t||null===(i=t.signal)||void 0===i||i.removeEventListener("abort",c)}}();try{for(;;){for(;a.length>0;){const e=await a[0];if(e===oi)return;if(l.aborted)throw new qn;e!==ii&&(yield e),a.shift(),d&&(d(),d=null)}await new ei((e=>{h=e}))}}finally{o.abort(),f=!0,d&&(d(),d=null)}}.call(this)}async function ai(e,t=void 0){for await(const r of li.call(this,e,t))return!0;return!1}function li(e,t){if("function"!=typeof e)throw new Un("fn",["Function","AsyncFunction"],e);return si.call(this,(async function(t,r){return await e(t,r)?t:ii}),t)}class ui extends Wn{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function ci(e){if(e=Jn(e),Xn(e))return 0;if(e<0)throw new Gn("number",">= 0",e);return e}lt.streamReturningOperators={asIndexedPairs:function(e=void 0){return null!=e&&Yn(e,"options"),null!=(null==e?void 0:e.signal)&&zn(e.signal,"options.signal"),async function*(){let t=0;for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new qn({cause:e.signal.reason});yield[t++,n]}}.call(this)},drop:function(e,t=void 0){return null!=t&&Yn(t,"options"),null!=(null==t?void 0:t.signal)&&zn(t.signal,"options.signal"),e=ci(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new qn;for await(const r of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new qn;e--<=0&&(yield r)}}.call(this)},filter:li,flatMap:function(e,t){const r=si.call(this,e,t);return async function*(){for await(const e of r)yield*e}.call(this)},map:si,take:function(e,t=void 0){return null!=t&&Yn(t,"options"),null!=(null==t?void 0:t.signal)&&zn(t.signal,"options.signal"),e=ci(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new qn;for await(const r of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new qn;if(!(e-- >0))return;yield r}}.call(this)}},lt.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new Un("fn",["Function","AsyncFunction"],e);return!await ai.call(this,(async(...t)=>!await e(...t)),t)},forEach:async function(e,t){if("function"!=typeof e)throw new Un("fn",["Function","AsyncFunction"],e);for await(const r of si.call(this,(async function(t,r){return await e(t,r),ii}),t));},reduce:async function(e,t,r){var n;if("function"!=typeof e)throw new Un("reducer",["Function","AsyncFunction"],e);null!=r&&Yn(r,"options"),null!=(null==r?void 0:r.signal)&&zn(r.signal,"options.signal");let i=arguments.length>1;if(null!=r&&null!==(n=r.signal)&&void 0!==n&&n.aborted){const e=new qn(void 0,{cause:r.signal.reason});throw this.once("error",(()=>{})),await Vn(this.destroy(e)),e}const o=new Fn,s=o.signal;if(null!=r&&r.signal){const e={once:!0,[Hn]:this};r.signal.addEventListener("abort",(()=>o.abort()),e)}let a=!1;try{for await(const n of this){var l;if(a=!0,null!=r&&null!==(l=r.signal)&&void 0!==l&&l.aborted)throw new qn;i?t=await e(t,n,{signal:s}):(t=n,i=!0)}if(!a&&!i)throw new ui}finally{o.abort()}return t},toArray:async function(e){null!=e&&Yn(e,"options"),null!=(null==e?void 0:e.signal)&&zn(e.signal,"options.signal");const t=[];for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new qn(void 0,{cause:e.signal.reason});Kn(t,n)}return t},some:ai,find:async function(e,t){for await(const r of li.call(this,e,t))return r}};const hi=Vr,{aggregateTwoErrors:di,codes:{ERR_MULTIPLE_CALLBACK:fi},AbortError:pi}=Rt,{Symbol:_i}=it,{kDestroyed:bi,isDestroyed:gi,isFinished:yi,isServerRequest:wi}=pn,mi=_i("kDestroy"),vi=_i("kConstruct");function Ei(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function Si(e,t,r){let n=!1;function i(t){if(n)return;n=!0;const i=e._readableState,o=e._writableState;Ei(t,o,i),o&&(o.closed=!0),i&&(i.closed=!0),"function"==typeof r&&r(t),t?hi.nextTick(Ri,e,t):hi.nextTick(xi,e)}try{e._destroy(t||null,i)}catch(t){i(t)}}function Ri(e,t){Ai(e,t),xi(e)}function xi(e){const t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(r&&r.emitClose||t&&t.emitClose)&&e.emit("close")}function Ai(e,t){const r=e._readableState,n=e._writableState;n&&n.errorEmitted||r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function Ii(e,t,r){const n=e._readableState,i=e._writableState;if(i&&i.destroyed||n&&n.destroyed)return this;n&&n.autoDestroy||i&&i.autoDestroy?e.destroy(t):t&&(t.stack,i&&!i.errored&&(i.errored=t),n&&!n.errored&&(n.errored=t),r?hi.nextTick(Ai,e,t):Ai(e,t))}function ji(e){let t=!1;function r(r){if(t)return void Ii(e,null!=r?r:new fi);t=!0;const n=e._readableState,i=e._writableState,o=i||n;n&&(n.constructed=!0),i&&(i.constructed=!0),o.destroyed?e.emit(mi,r):r?Ii(e,r,!0):hi.nextTick(ki,e)}try{e._construct(r)}catch(e){r(e)}}function ki(e){e.emit(vi)}function Ti(e){return e&&e.setHeader&&"function"==typeof e.abort}function Pi(e){e.emit("close")}function Ni(e,t){e.emit("error",t),hi.nextTick(Pi,e)}var Li={construct:function(e,t){if("function"!=typeof e._construct)return;const r=e._readableState,n=e._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),e.once(vi,t),e.listenerCount(vi)>1||hi.nextTick(ji,e)},destroyer:function(e,t){e&&!gi(e)&&(t||yi(e)||(t=new pi),wi(e)?(e.socket=null,e.destroy(t)):Ti(e)?e.abort():Ti(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?hi.nextTick(Ni,e,t):hi.nextTick(Pi,e),e.destroyed||(e[bi]=!0))},destroy:function(e,t){const r=this._readableState,n=this._writableState,i=n||r;return n&&n.destroyed||r&&r.destroyed?("function"==typeof t&&t(),this):(Ei(e,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),i.constructed?Si(this,e,t):this.once(mi,(function(r){Si(this,di(r,e),t)})),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:Ii};function Oi(){}function Mi(){Mi.init.call(this)}function Di(e){return void 0===e._maxListeners?Mi.defaultMaxListeners:e._maxListeners}function $i(e,t,r,n){var i,o,s,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]):(o=e._events=new Oi,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=Di(e))&&i>0&&s.length>i){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,a=l,"function"==typeof console.warn?console.warn(a):console.log(a)}}else s=o[t]=r,++e._eventsCount;return e}function Ci(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function Bi(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function Fi(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}Oi.prototype=Object.create(null),Mi.EventEmitter=Mi,Mi.usingDomains=!1,Mi.prototype.domain=void 0,Mi.prototype._events=void 0,Mi.prototype._maxListeners=void 0,Mi.defaultMaxListeners=10,Mi.init=function(){this.domain=null,Mi.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Oi,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Mi.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Mi.prototype.getMaxListeners=function(){return Di(this)},Mi.prototype.emit=function(e){var t,r,n,i,o,s,a,l="error"===e;if(s=this._events)l=l&&null==s.error;else if(!l)return!1;if(a=this.domain,l){if(t=arguments[1],!a){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(r=s[e]))return!1;var c="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=Fi(e,n),o=0;o<n;++o)i[o].call(r)}(r,c,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=Fi(e,i),s=0;s<i;++s)o[s].call(r,n)}(r,c,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,s=Fi(e,o),a=0;a<o;++a)s[a].call(r,n,i)}(r,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var s=e.length,a=Fi(e,s),l=0;l<s;++l)a[l].call(r,n,i,o)}(r,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=Fi(e,i),s=0;s<i;++s)o[s].apply(r,n)}(r,c,this,i)}return!0},Mi.prototype.addListener=function(e,t){return $i(this,e,t,!1)},Mi.prototype.on=Mi.prototype.addListener,Mi.prototype.prependListener=function(e,t){return $i(this,e,t,!0)},Mi.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Ci(this,e,t)),this},Mi.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Ci(this,e,t)),this},Mi.prototype.removeListener=function(e,t){var r,n,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new Oi:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new Oi,this;delete n[e]}else!function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,i);n.removeListener&&this.emit("removeListener",e,s||t)}return this},Mi.prototype.off=function(e,t){return this.removeListener(e,t)},Mi.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new Oi,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new Oi:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new Oi,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Mi.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[]},Mi.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Bi.call(e,t)},Mi.prototype.listenerCount=Bi,Mi.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Ui=h(Object.freeze({__proto__:null,EventEmitter:Mi,default:Mi}));const{ArrayIsArray:Wi,ObjectSetPrototypeOf:Gi}=it,{EventEmitter:qi}=Ui;function zi(e){qi.call(this,e)}function Qi(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Wi(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}Gi(zi.prototype,qi.prototype),Gi(zi,qi),zi.prototype.pipe=function(e,t){const r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",a));let o=!1;function s(){o||(o=!0,e.end())}function a(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){u(),0===qi.listenerCount(this,"error")&&this.emit("error",e)}function u(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",l),e.removeListener("error",l),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return Qi(r,"error",l),Qi(e,"error",l),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e};var Yi={Stream:zi,prependListener:Qi},Hi={exports:{}};!function(e){const{AbortError:t,codes:r}=Rt,n=Bn,{ERR_INVALID_ARG_TYPE:i}=r;e.exports.addAbortSignal=function(t,r){if(((e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new i(t,"AbortSignal",e)})(t,"signal"),!(n=r)||"function"!=typeof n.pipe)throw new i("stream","stream.Stream",r);var n;return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,r){if("object"!=typeof e||!("aborted"in e))return r;const i=()=>{r.destroy(new t(void 0,{cause:e.reason}))};return e.aborted?i():(e.addEventListener("abort",i),n(r,(()=>e.removeEventListener("abort",i)))),r}}(Hi);var Vi=Hi.exports;const{StringPrototypeSlice:Ki,SymbolIterator:Zi,TypedArrayPrototypeSet:Ji,Uint8Array:Xi}=it,{Buffer:eo}=nt,{inspect:to}=at;var ro=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return eo.alloc(0);const t=eo.allocUnsafe(e>>>0);let r=this.head,n=0;for(;r;)Ji(t,r.data,n),n+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[Zi](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,n=0;do{const i=r.data;if(!(e>i.length)){e===i.length?(t+=i,++n,r.next?this.head=r.next:this.head=this.tail=null):(t+=Ki(i,0,e),this.head=r,r.data=Ki(i,e));break}t+=i,e-=i.length,++n}while(null!==(r=r.next));return this.length-=n,t}_getBuffer(e){const t=eo.allocUnsafe(e),r=e;let n=this.head,i=0;do{const o=n.data;if(!(e>o.length)){e===o.length?(Ji(t,o,r-e),++i,n.next?this.head=n.next:this.head=this.tail=null):(Ji(t,new Xi(o.buffer,o.byteOffset,e),r-e),this.head=n,n.data=o.slice(e));break}Ji(t,o,r-e),e-=o.length,++i}while(null!==(n=n.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return to(this,{...t,depth:0,customInspect:!1})}};const{MathFloor:no,NumberIsInteger:io}=it,{ERR_INVALID_ARG_VALUE:oo}=Rt.codes;function so(e){return e?16:16384}var ao={getHighWaterMark:function(e,t,r,n){const i=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,n,r);if(null!=i){if(!io(i)||i<0){throw new oo(n?`options.${r}`:"options.highWaterMark",i)}return no(i)}return so(e.objectMode)},getDefaultHighWaterMark:so},lo=ye.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function uo(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!lo(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=ho;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=fo;break;default:return void(this.write=co)}this.charBuffer=new ye(6),this.charReceived=0,this.charLength=0}function co(e){return e.toString(this.encoding)}function ho(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function fo(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}uo.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},uo.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},uo.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t};var po=h(Object.freeze({__proto__:null,StringDecoder:uo}));const _o=Vr,{PromisePrototypeThen:bo,SymbolAsyncIterator:go,SymbolIterator:yo}=it,{Buffer:wo}=nt,{ERR_INVALID_ARG_TYPE:mo,ERR_STREAM_NULL_VALUES:vo}=Rt.codes;var Eo,So,Ro,xo,Ao,Io,jo,ko,To=function(e,t,r){let n,i;if("string"==typeof t||t instanceof wo)return new e({objectMode:!0,...r,read(){this.push(t),this.push(null)}});if(t&&t[go])i=!0,n=t[go]();else{if(!t||!t[yo])throw new mo("iterable",["Iterable"],t);i=!1,n=t[yo]()}const o=new e({objectMode:!0,highWaterMark:1,...r});let s=!1;return o._read=function(){s||(s=!0,async function(){for(;;){try{const{value:e,done:t}=i?await n.next():n.next();if(t)o.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw s=!1,new vo;if(o.push(t))continue;s=!1}}catch(e){o.destroy(e)}break}}())},o._destroy=function(e,t){bo(async function(e){const t=null!=e,r="function"==typeof n.throw;if(t&&r){const{value:t,done:r}=await n.throw(e);if(await t,r)return}if("function"==typeof n.return){const{value:e}=await n.return();await e}}(e),(()=>_o.nextTick(t,e)),(r=>_o.nextTick(t,r||e)))},o};function Po(){if(So)return Eo;So=1;const e=Vr,{ArrayPrototypeIndexOf:t,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:i,ObjectDefineProperties:o,ObjectKeys:s,ObjectSetPrototypeOf:a,Promise:l,SafeSet:u,SymbolAsyncIterator:c,Symbol:h}=it;Eo=D,D.ReadableState=M;const{EventEmitter:d}=Ui,{Stream:f,prependListener:p}=Yi,{Buffer:_}=nt,{addAbortSignal:b}=Vi,g=Bn;let y=at.debuglog("stream",(e=>{y=e}));const w=ro,m=Li,{getHighWaterMark:v,getDefaultHighWaterMark:E}=ao,{aggregateTwoErrors:S,codes:{ERR_INVALID_ARG_TYPE:R,ERR_METHOD_NOT_IMPLEMENTED:x,ERR_OUT_OF_RANGE:A,ERR_STREAM_PUSH_AFTER_EOF:I,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:j}}=Rt,{validateObject:k}=ur,T=h("kPaused"),{StringDecoder:P}=po,N=To;a(D.prototype,f.prototype),a(D,f);const L=()=>{},{errorOrDestroy:O}=m;function M(e,t,r){"boolean"!=typeof r&&(r=t instanceof Oo()),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.readableObjectMode)),this.highWaterMark=e?v(this,e,"readableHighWaterMark",r):E(!1),this.buffer=new w,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[T]=null,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new P(e.encoding),this.encoding=e.encoding)}function D(e){if(!(this instanceof D))return new D(e);const t=this instanceof Oo();this._readableState=new M(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&b(e.signal,this)),f.call(this,e),m.construct(this,(()=>{this._readableState.needReadable&&W(this,this._readableState)}))}function $(e,t,r,n){y("readableAddChunk",t);const i=e._readableState;let o;if(i.objectMode||("string"==typeof t?(r=r||i.defaultEncoding,i.encoding!==r&&(n&&i.encoding?t=_.from(t,r).toString(i.encoding):(t=_.from(t,r),r=""))):t instanceof _?r="":f._isUint8Array(t)?(t=f._uint8ArrayToBuffer(t),r=""):null!=t&&(o=new R("chunk",["string","Buffer","Uint8Array"],t))),o)O(e,o);else if(null===t)i.reading=!1,function(e,t){if(y("onEofChunk"),t.ended)return;if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?F(e):(t.needReadable=!1,t.emittedReadable=!0,U(e))}(e,i);else if(i.objectMode||t&&t.length>0)if(n)if(i.endEmitted)O(e,new j);else{if(i.destroyed||i.errored)return!1;C(e,i,t,!0)}else if(i.ended)O(e,new I);else{if(i.destroyed||i.errored)return!1;i.reading=!1,i.decoder&&!r?(t=i.decoder.write(t),i.objectMode||0!==t.length?C(e,i,t,!1):W(e,i)):C(e,i,t,!1)}else n||(i.reading=!1,W(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function C(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&F(e)),W(e,t)}D.prototype.destroy=m.destroy,D.prototype._undestroy=m.undestroy,D.prototype._destroy=function(e,t){t(e)},D.prototype[d.captureRejectionSymbol]=function(e){this.destroy(e)},D.prototype.push=function(e,t){return $(this,e,t,!1)},D.prototype.unshift=function(e,t){return $(this,e,t,!0)},D.prototype.isPaused=function(){const e=this._readableState;return!0===e[T]||!1===e.flowing},D.prototype.setEncoding=function(e){const t=new P(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const r=this._readableState.buffer;let n="";for(const e of r)n+=t.write(e);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this};function B(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:n(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function F(t){const r=t._readableState;y("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(y("emitReadable",r.flowing),r.emittedReadable=!0,e.nextTick(U,t))}function U(e){const t=e._readableState;y("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,Y(e)}function W(t,r){!r.readingMore&&r.constructed&&(r.readingMore=!0,e.nextTick(G,t,r))}function G(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const r=t.length;if(y("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function q(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[T]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function z(e){y("readable nexttick read 0"),e.read(0)}function Q(e,t){y("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),Y(e),t.flowing&&!t.reading&&e.read(0)}function Y(e){const t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function H(e,t){"function"!=typeof e.read&&(e=D.wrap(e,{objectMode:!0}));const r=async function*(e,t){let r,n=L;function i(t){this===e?(n(),n=L):n=t}e.on("readable",i);const o=g(e,{writable:!1},(e=>{r=e?S(r,e):null,n(),n=L}));try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(r)throw r;if(null===r)return;await new l(i)}}}catch(e){throw r=S(r,e),r}finally{!r&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==r&&!e._readableState.autoDestroy?(e.off("readable",i),o()):m.destroyer(e,null)}}(e,t);return r.stream=e,r}function V(e,t){if(0===t.length)return null;let r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function K(t){const r=t._readableState;y("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,e.nextTick(Z,r,t))}function Z(t,r){if(y("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&0===t.length)if(t.endEmitted=!0,r.emit("end"),r.writable&&!1===r.allowHalfOpen)e.nextTick(J,r);else if(t.autoDestroy){const e=r._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&r.destroy()}}function J(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let X;function ee(){return void 0===X&&(X={}),X}return D.prototype.read=function(e){y("read",e),void 0===e?e=NaN:r(e)||(e=i(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new A("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return y("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?K(this):F(this),null;if(0===(e=B(e,t))&&t.ended)return 0===t.length&&K(this),null;let o,s=t.needReadable;if(y("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&(s=!0,y("length less than watermark",s)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)s=!1,y("reading, ended or constructing",s);else if(s){y("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0);try{this._read(t.highWaterMark)}catch(e){O(this,e)}t.sync=!1,t.reading||(e=B(n,t))}return o=e>0?V(e,t):null,null===o?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&K(this)),null===o||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",o)),o},D.prototype._read=function(e){throw new x("_read()")},D.prototype.pipe=function(t,r){const n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new u(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(t),y("pipe count=%d opts=%j",i.pipes.length,r);const o=(!r||!1!==r.end)&&t!==e.stdout&&t!==e.stderr?a:g;function s(e,r){y("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,function(){y("cleanup"),t.removeListener("close",_),t.removeListener("finish",b),l&&t.removeListener("drain",l);t.removeListener("error",f),t.removeListener("unpipe",s),n.removeListener("end",a),n.removeListener("end",g),n.removeListener("data",d),c=!0,l&&i.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&l()}())}function a(){y("onend"),t.end()}let l;i.endEmitted?e.nextTick(o):n.once("end",o),t.on("unpipe",s);let c=!1;function h(){c||(1===i.pipes.length&&i.pipes[0]===t?(y("false write response, pause",0),i.awaitDrainWriters=t,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(t)&&(y("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(t)),n.pause()),l||(l=function(e,t){return function(){const r=e._readableState;r.awaitDrainWriters===t?(y("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(y("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),r.awaitDrainWriters&&0!==r.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,t),t.on("drain",l))}function d(e){y("ondata");const r=t.write(e);y("dest.write",r),!1===r&&h()}function f(e){if(y("onerror",e),g(),t.removeListener("error",f),0===t.listenerCount("error")){const r=t._writableState||t._readableState;r&&!r.errorEmitted?O(t,e):t.emit("error",e)}}function _(){t.removeListener("finish",b),g()}function b(){y("onfinish"),t.removeListener("close",_),g()}function g(){y("unpipe"),n.unpipe(t)}return n.on("data",d),p(t,"error",f),t.once("close",_),t.once("finish",b),t.emit("pipe",n),!0===t.writableNeedDrain?i.flowing&&h():i.flowing||(y("pipe resume"),n.resume()),t},D.prototype.unpipe=function(e){const r=this._readableState;if(0===r.pipes.length)return this;if(!e){const e=r.pipes;r.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=t(r.pipes,e);return-1===n||(r.pipes.splice(n,1),0===r.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},D.prototype.on=function(t,r){const n=f.prototype.on.call(this,t,r),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,y("on readable",i.length,i.reading),i.length?F(this):i.reading||e.nextTick(z,this))),n},D.prototype.addListener=D.prototype.on,D.prototype.removeListener=function(t,r){const n=f.prototype.removeListener.call(this,t,r);return"readable"===t&&e.nextTick(q,this),n},D.prototype.off=D.prototype.removeListener,D.prototype.removeAllListeners=function(t){const r=f.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||e.nextTick(q,this),r},D.prototype.resume=function(){const t=this._readableState;return t.flowing||(y("resume"),t.flowing=!t.readableListening,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(Q,t,r))}(this,t)),t[T]=!1,this},D.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[T]=!0,this},D.prototype.wrap=function(e){let t=!1;e.on("data",(r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{O(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const r=s(e);for(let t=1;t<r.length;t++){const n=r[t];void 0===this[n]&&"function"==typeof e[n]&&(this[n]=e[n].bind(e))}return this},D.prototype[c]=function(){return H(this)},D.prototype.iterator=function(e){return void 0!==e&&k(e,"options"),H(this,e)},o(D.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),o(M.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[T]},set(e){this[T]=!!e}}}),D._fromList=V,D.from=function(e,t){return N(D,e,t)},D.fromWeb=function(e,t){return ee().newStreamReadableFromReadableStream(e,t)},D.toWeb=function(e,t){return ee().newReadableStreamFromStreamReadable(e,t)},D.wrap=function(e,t){var r,n;return new D({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r,...t,destroy(t,r){m.destroyer(e,t),r(t)}}).wrap(e)},Eo}function No(){if(xo)return Ro;xo=1;const e=Vr,{ArrayPrototypeSlice:t,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:i,ObjectDefineProperties:o,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:a,Symbol:l,SymbolHasInstance:u}=it;Ro=P,P.WritableState=k;const{EventEmitter:c}=Ui,h=Yi.Stream,{Buffer:d}=nt,f=Li,{addAbortSignal:p}=Vi,{getHighWaterMark:_,getDefaultHighWaterMark:b}=ao,{ERR_INVALID_ARG_TYPE:g,ERR_METHOD_NOT_IMPLEMENTED:y,ERR_MULTIPLE_CALLBACK:w,ERR_STREAM_CANNOT_PIPE:m,ERR_STREAM_DESTROYED:v,ERR_STREAM_ALREADY_FINISHED:E,ERR_STREAM_NULL_VALUES:S,ERR_STREAM_WRITE_AFTER_END:R,ERR_UNKNOWN_ENCODING:x}=Rt.codes,{errorOrDestroy:A}=f;function I(){}s(P.prototype,h.prototype),s(P,h);const j=l("kOnFinished");function k(e,t,r){"boolean"!=typeof r&&(r=t instanceof Oo()),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?_(this,e,"writableHighWaterMark",r):b(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const n=!(!e||!1!==e.decodeStrings);this.decodeStrings=!n,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=M.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,T(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[j]=[]}function T(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function P(e){const t=this instanceof Oo();if(!t&&!n(P,this))return new P(e);this._writableState=new k(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&p(e.signal,this)),h.call(this,e),f.construct(this,(()=>{const e=this._writableState;e.writing||B(this,e),W(this,e)}))}function N(t,r,n,i){const o=t._writableState;if("function"==typeof n)i=n,n=o.defaultEncoding;else{if(n){if("buffer"!==n&&!d.isEncoding(n))throw new x(n)}else n=o.defaultEncoding;"function"!=typeof i&&(i=I)}if(null===r)throw new S;if(!o.objectMode)if("string"==typeof r)!1!==o.decodeStrings&&(r=d.from(r,n),n="buffer");else if(r instanceof d)n="buffer";else{if(!h._isUint8Array(r))throw new g("chunk",["string","Buffer","Uint8Array"],r);r=h._uint8ArrayToBuffer(r),n="buffer"}let s;return o.ending?s=new R:o.destroyed&&(s=new v("write")),s?(e.nextTick(i,s),A(t,s,!0),s):(o.pendingcb++,function(e,t,r,n,i){const o=t.objectMode?1:r.length;t.length+=o;const s=t.length<t.highWaterMark;s||(t.needDrain=!0);t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==I&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1);return s&&!t.errored&&!t.destroyed}(t,o,r,n,i))}function L(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function O(e,t,r,n){--t.pendingcb,n(r),C(t),A(e,r)}function M(t,r){const n=t._writableState,i=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,r?(r.stack,n.errored||(n.errored=r),t._readableState&&!t._readableState.errored&&(t._readableState.errored=r),i?e.nextTick(O,t,n,r,o):O(t,n,r,o)):(n.buffered.length>n.bufferedIndex&&B(t,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:t,state:n},e.nextTick(D,n.afterWriteTickInfo)):$(t,n,1,o))):A(t,new w)}function D({stream:e,state:t,count:r,cb:n}){return t.afterWriteTickInfo=null,$(e,t,r,n)}function $(e,t,r,n){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&C(t),W(e,t)}function C(e){if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){var t;const{chunk:n,callback:i}=e.buffered[r],o=e.objectMode?1:n.length;e.length-=o,i(null!==(t=e.errored)&&void 0!==t?t:new v("write"))}const r=e[j].splice(0);for(let t=0;t<r.length;t++){var n;r[t](null!==(n=e.errored)&&void 0!==n?n:new v("end"))}T(e)}function B(e,r){if(r.corked||r.bufferProcessing||r.destroyed||!r.constructed)return;const{buffered:n,bufferedIndex:i,objectMode:o}=r,s=n.length-i;if(!s)return;let a=i;if(r.bufferProcessing=!0,s>1&&e._writev){r.pendingcb-=s-1;const i=r.allNoop?I:e=>{for(let t=a;t<n.length;++t)n[t].callback(e)},o=r.allNoop&&0===a?n:t(n,a);o.allBuffers=r.allBuffers,L(e,r,!0,r.length,o,"",i),T(r)}else{do{const{chunk:t,encoding:i,callback:s}=n[a];n[a++]=null;L(e,r,!1,o?1:t.length,t,i,s)}while(a<n.length&&!r.writing);a===n.length?T(r):a>256?(n.splice(0,a),r.bufferedIndex=0):r.bufferedIndex=a}r.bufferProcessing=!1}function F(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function U(t,r){r.prefinished||r.finalCalled||("function"!=typeof t._final||r.destroyed?(r.prefinished=!0,t.emit("prefinish")):(r.finalCalled=!0,function(t,r){let n=!1;function i(i){if(n)A(t,null!=i?i:w());else if(n=!0,r.pendingcb--,i){const e=r[j].splice(0);for(let t=0;t<e.length;t++)e[t](i);A(t,i,r.sync)}else F(r)&&(r.prefinished=!0,t.emit("prefinish"),r.pendingcb++,e.nextTick(G,t,r))}r.sync=!0,r.pendingcb++;try{t._final(i)}catch(e){i(e)}r.sync=!1}(t,r)))}function W(t,r,n){F(r)&&(U(t,r),0===r.pendingcb&&(n?(r.pendingcb++,e.nextTick(((e,t)=>{F(t)?G(e,t):t.pendingcb--}),t,r)):F(r)&&(r.pendingcb++,G(t,r))))}function G(e,t){t.pendingcb--,t.finished=!0;const r=t[j].splice(0);for(let e=0;e<r.length;e++)r[e]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},i(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),i(P,u,{__proto__:null,value:function(e){return!!n(this,e)||this===P&&(e&&e._writableState instanceof k)}}),P.prototype.pipe=function(){A(this,new m)},P.prototype.write=function(e,t,r){return!0===N(this,e,t,r)},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||B(this,e))},P.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=a(e)),!d.isEncoding(e))throw new x(e);return this._writableState.defaultEncoding=e,this},P.prototype._write=function(e,t,r){if(!this._writev)throw new y("_write()");this._writev([{chunk:e,encoding:t}],r)},P.prototype._writev=null,P.prototype.end=function(t,n,i){const o=this._writableState;let s;if("function"==typeof t?(i=t,t=null,n=null):"function"==typeof n&&(i=n,n=null),null!=t){const e=N(this,t,n);e instanceof r&&(s=e)}return o.corked&&(o.corked=1,this.uncork()),s||(o.errored||o.ending?o.finished?s=new E("end"):o.destroyed&&(s=new v("end")):(o.ending=!0,W(this,o,!0),o.ended=!0)),"function"==typeof i&&(s||o.finished?e.nextTick(i,s):o[j].push(i)),this},o(P.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const q=f.destroy;let z;function Q(){return void 0===z&&(z={}),z}return P.prototype.destroy=function(t,r){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[j].length)&&e.nextTick(C,n),q.call(this,t,r),this},P.prototype._undestroy=f.undestroy,P.prototype._destroy=function(e,t){t(e)},P.prototype[c.captureRejectionSymbol]=function(e){this.destroy(e)},P.fromWeb=function(e,t){return Q().newStreamWritableFromWritableStream(e,t)},P.toWeb=function(e){return Q().newWritableStreamFromStreamWritable(e)},Ro}function Lo(){if(Io)return Ao;Io=1;const e=Vr,t=nt,{isReadable:r,isWritable:n,isIterable:i,isNodeStream:o,isReadableNodeStream:s,isWritableNodeStream:a,isDuplexNodeStream:l}=pn,u=Bn,{AbortError:c,codes:{ERR_INVALID_ARG_TYPE:h,ERR_INVALID_RETURN_VALUE:d}}=Rt,{destroyer:f}=Li,p=Oo(),_=Po(),{createDeferredPromise:b}=at,g=To,y=globalThis.Blob||t.Blob,w=void 0!==y?function(e){return e instanceof y}:function(e){return!1},m=globalThis.AbortController||ct().AbortController,{FunctionPrototypeCall:v}=it;class E extends p{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function S(e){const t=e.readable&&"function"!=typeof e.readable.read?_.wrap(e.readable):e.readable,i=e.writable;let o,s,a,l,h,d=!!r(t),p=!!n(i);function b(e){const t=l;l=null,t?t(e):e?h.destroy(e):d||p||h.destroy()}return h=new E({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==i||!i.writableObjectMode),readable:d,writable:p}),p&&(u(i,(e=>{p=!1,e&&f(t,e),b(e)})),h._write=function(e,t,r){i.write(e,t)?r():o=r},h._final=function(e){i.end(),s=e},i.on("drain",(function(){if(o){const e=o;o=null,e()}})),i.on("finish",(function(){if(s){const e=s;s=null,e()}}))),d&&(u(t,(e=>{d=!1,e&&f(t,e),b(e)})),t.on("readable",(function(){if(a){const e=a;a=null,e()}})),t.on("end",(function(){h.push(null)})),h._read=function(){for(;;){const e=t.read();if(null===e)return void(a=h._read);if(!h.push(e))return}}),h._destroy=function(e,r){e||null===l||(e=new c),a=null,o=null,s=null,null===l?r(e):(l=r,f(i,e),f(t,e))},h}return Ao=function t(r,n){if(l(r))return r;if(s(r))return S({readable:r});if(a(r))return S({writable:r});if(o(r))return S({writable:!1,readable:!1});if("function"==typeof r){const{value:t,write:o,final:s,destroy:a}=function(t){let{promise:r,resolve:n}=b();const i=new m,o=i.signal,s=t(async function*(){for(;;){const t=r;r=null;const{chunk:i,done:s,cb:a}=await t;if(e.nextTick(a),s)return;if(o.aborted)throw new c(void 0,{cause:o.reason});({promise:r,resolve:n}=b()),yield i}}(),{signal:o});return{value:s,write(e,t,r){const i=n;n=null,i({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}(r);if(i(t))return g(E,t,{objectMode:!0,write:o,final:s,destroy:a});const l=null==t?void 0:t.then;if("function"==typeof l){let r;const n=v(l,t,(e=>{if(null!=e)throw new d("nully","body",e)}),(e=>{f(r,e)}));return r=new E({objectMode:!0,readable:!1,write:o,final(t){s((async()=>{try{await n,e.nextTick(t,null)}catch(r){e.nextTick(t,r)}}))},destroy:a})}throw new d("Iterable, AsyncIterable or AsyncFunction",n,t)}if(w(r))return t(r.arrayBuffer());if(i(r))return g(E,r,{objectMode:!0,writable:!1});if("object"==typeof(null==r?void 0:r.writable)||"object"==typeof(null==r?void 0:r.readable)){return S({readable:null!=r&&r.readable?s(null==r?void 0:r.readable)?null==r?void 0:r.readable:t(r.readable):void 0,writable:null!=r&&r.writable?a(null==r?void 0:r.writable)?null==r?void 0:r.writable:t(r.writable):void 0})}const u=null==r?void 0:r.then;if("function"==typeof u){let e;return v(u,r,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{f(e,t)})),e=new E({objectMode:!0,writable:!1,read(){}})}throw new h(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],r)},Ao}function Oo(){if(ko)return jo;ko=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:r,ObjectSetPrototypeOf:n}=it;jo=s;const i=Po(),o=No();n(s.prototype,i.prototype),n(s,i);{const e=r(o.prototype);for(let t=0;t<e.length;t++){const r=e[t];s.prototype[r]||(s.prototype[r]=o.prototype[r])}}function s(e){if(!(this instanceof s))return new s(e);i.call(this,e),o.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let a,l;function u(){return void 0===a&&(a={}),a}return e(s.prototype,{writable:{__proto__:null,...t(o.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(o.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(o.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(o.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(o.prototype,"writableLength")},writableFinished:{__proto__:null,...t(o.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(o.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(o.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(o.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),s.fromWeb=function(e,t){return u().newStreamDuplexFromReadableWritablePair(e,t)},s.toWeb=function(e){return u().newReadableWritablePairFromDuplex(e)},s.from=function(e){return l||(l=Lo()),l(e,"body")},jo}const{ObjectSetPrototypeOf:Mo,Symbol:Do}=it;var $o=Wo;const{ERR_METHOD_NOT_IMPLEMENTED:Co}=Rt.codes,Bo=Oo(),{getHighWaterMark:Fo}=ao;Mo(Wo.prototype,Bo.prototype),Mo(Wo,Bo);const Uo=Do("kCallback");function Wo(e){if(!(this instanceof Wo))return new Wo(e);const t=e?Fo(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),Bo.call(this,e),this._readableState.sync=!1,this[Uo]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",qo)}function Go(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,r)=>{t?e?e(t):this.destroy(t):(null!=r&&this.push(r),this.push(null),e&&e())}))}function qo(){this._final!==Go&&Go.call(this)}Wo.prototype._final=Go,Wo.prototype._transform=function(e,t,r){throw new Co("_transform()")},Wo.prototype._write=function(e,t,r){const n=this._readableState,i=this._writableState,o=n.length;this._transform(e,t,((e,t)=>{e?r(e):(null!=t&&this.push(t),i.ended||o===n.length||n.length<n.highWaterMark?r():this[Uo]=r)}))},Wo.prototype._read=function(){if(this[Uo]){const e=this[Uo];this[Uo]=null,e()}};const{ObjectSetPrototypeOf:zo}=it;var Qo=Ho;const Yo=$o;function Ho(e){if(!(this instanceof Ho))return new Ho(e);Yo.call(this,e)}zo(Ho.prototype,Yo.prototype),zo(Ho,Yo),Ho.prototype._transform=function(e,t,r){r(null,e)};const Vo=Vr,{ArrayIsArray:Ko,Promise:Zo,SymbolAsyncIterator:Jo}=it,Xo=Bn,{once:es}=at,ts=Li,rs=Oo(),{aggregateTwoErrors:ns,codes:{ERR_INVALID_ARG_TYPE:is,ERR_INVALID_RETURN_VALUE:os,ERR_MISSING_ARGS:ss,ERR_STREAM_DESTROYED:as,ERR_STREAM_PREMATURE_CLOSE:ls},AbortError:us}=Rt,{validateFunction:cs,validateAbortSignal:hs}=ur,{isIterable:ds,isReadable:fs,isReadableNodeStream:ps,isNodeStream:_s}=pn,bs=globalThis.AbortController||ct().AbortController;let gs,ys;function ws(e,t,r){let n=!1;e.on("close",(()=>{n=!0}));return{destroy:t=>{n||(n=!0,ts.destroyer(e,t||new as("pipe")))},cleanup:Xo(e,{readable:t,writable:r},(e=>{n=!e}))}}function ms(e){if(ds(e))return e;if(ps(e))return async function*(e){ys||(ys=Po());yield*ys.prototype[Jo].call(e)}(e);throw new is("val",["Readable","Iterable","AsyncIterable"],e)}async function vs(e,t,r,{end:n}){let i,o=null;const s=e=>{if(e&&(i=e),o){const e=o;o=null,e()}},a=()=>new Zo(((e,t)=>{i?t(i):o=()=>{i?t(i):e()}}));t.on("drain",s);const l=Xo(t,{readable:!1},s);try{t.writableNeedDrain&&await a();for await(const r of e)t.write(r)||await a();n&&t.end(),await a(),r()}catch(e){r(i!==e?ns(i,e):e)}finally{l(),t.off("drain",s)}}function Es(e,t,r){if(1===e.length&&Ko(e[0])&&(e=e[0]),e.length<2)throw new ss("streams");const n=new bs,i=n.signal,o=null==r?void 0:r.signal,s=[];function a(){p(new us)}let l,u;hs(o,"options.signal"),null==o||o.addEventListener("abort",a);const c=[];let h,d=0;function f(e){p(e,0==--d)}function p(e,r){if(!e||l&&"ERR_STREAM_PREMATURE_CLOSE"!==l.code||(l=e),l||r){for(;c.length;)c.shift()(l);null==o||o.removeEventListener("abort",a),n.abort(),r&&(l||s.forEach((e=>e())),Vo.nextTick(t,l,u))}}for(let b=0;b<e.length;b++){const g=e[b],y=b<e.length-1,w=b>0,m=y||!1!==(null==r?void 0:r.end),v=b===e.length-1;if(_s(g)){if(m){const{destroy:S,cleanup:R}=ws(g,y,w);c.push(S),fs(g)&&v&&s.push(R)}function E(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&f(e)}g.on("error",E),fs(g)&&v&&s.push((()=>{g.removeListener("error",E)}))}if(0===b)if("function"==typeof g){if(h=g({signal:i}),!ds(h))throw new os("Iterable, AsyncIterable or Stream","source",h)}else h=ds(g)||ps(g)?g:rs.from(g);else if("function"==typeof g)if(h=ms(h),h=g(h,{signal:i}),y){if(!ds(h,!0))throw new os("AsyncIterable",`transform[${b-1}]`,h)}else{var _;gs||(gs=Qo);const x=new gs({objectMode:!0}),A=null===(_=h)||void 0===_?void 0:_.then;if("function"==typeof A)d++,A.call(h,(e=>{u=e,null!=e&&x.write(e),m&&x.end(),Vo.nextTick(f)}),(e=>{x.destroy(e),Vo.nextTick(f,e)}));else{if(!ds(h,!0))throw new os("AsyncIterable or Promise","destination",h);d++,vs(h,x,f,{end:m})}h=x;const{destroy:I,cleanup:j}=ws(h,!1,!0);c.push(I),v&&s.push(j)}else if(_s(g)){if(ps(h)){d+=2;const k=Ss(h,g,f,{end:m});fs(g)&&v&&s.push(k)}else{if(!ds(h))throw new is("val",["Readable","Iterable","AsyncIterable"],h);d++,vs(h,g,f,{end:m})}h=g}else h=rs.from(g)}return(null!=i&&i.aborted||null!=o&&o.aborted)&&Vo.nextTick(a),h}function Ss(e,t,r,{end:n}){let i=!1;return t.on("close",(()=>{i||r(new ls)})),e.pipe(t,{end:n}),n?e.once("end",(()=>{i=!0,t.end()})):r(),Xo(e,{readable:!0,writable:!1},(t=>{const n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)})),Xo(t,{readable:!1,writable:!0},r)}var Rs={pipelineImpl:Es,pipeline:function(...e){return Es(e,es(function(e){return cs(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}};const{pipeline:xs}=Rs,As=Oo(),{destroyer:Is}=Li,{isNodeStream:js,isReadable:ks,isWritable:Ts}=pn,{AbortError:Ps,codes:{ERR_INVALID_ARG_VALUE:Ns,ERR_MISSING_ARGS:Ls}}=Rt;const{ArrayPrototypePop:Os,Promise:Ms}=it,{isIterable:Ds,isNodeStream:$s}=pn,{pipelineImpl:Cs}=Rs,{finished:Bs}=Bn;var Fs={finished:Bs,pipeline:function(...e){return new Ms(((t,r)=>{let n,i;const o=e[e.length-1];if(o&&"object"==typeof o&&!$s(o)&&!Ds(o)){const t=Os(e);n=t.signal,i=t.end}Cs(e,((e,n)=>{e?r(e):t(n)}),{signal:n,end:i})}))}};const{Buffer:Us}=nt,{ObjectDefineProperty:Ws,ObjectKeys:Gs,ReflectApply:qs}=it,{promisify:{custom:zs}}=at,{streamReturningOperators:Qs,promiseReturningOperators:Ys}=lt,{codes:{ERR_ILLEGAL_CONSTRUCTOR:Hs}}=Rt,Vs=function(...e){if(0===e.length)throw new Ls("streams");if(1===e.length)return As.from(e[0]);const t=[...e];if("function"==typeof e[0]&&(e[0]=As.from(e[0])),"function"==typeof e[e.length-1]){const t=e.length-1;e[t]=As.from(e[t])}for(let r=0;r<e.length;++r)if(js(e[r])){if(r<e.length-1&&!ks(e[r]))throw new Ns(`streams[${r}]`,t[r],"must be readable");if(r>0&&!Ts(e[r]))throw new Ns(`streams[${r}]`,t[r],"must be writable")}let r,n,i,o,s;const a=e[0],l=xs(e,(function(e){const t=o;o=null,t?t(e):e?s.destroy(e):c||u||s.destroy()})),u=!!Ts(a),c=!!ks(l);return s=new As({writableObjectMode:!(null==a||!a.writableObjectMode),readableObjectMode:!(null==l||!l.writableObjectMode),writable:u,readable:c}),u&&(s._write=function(e,t,n){a.write(e,t)?n():r=n},s._final=function(e){a.end(),n=e},a.on("drain",(function(){if(r){const e=r;r=null,e()}})),l.on("finish",(function(){if(n){const e=n;n=null,e()}}))),c&&(l.on("readable",(function(){if(i){const e=i;i=null,e()}})),l.on("end",(function(){s.push(null)})),s._read=function(){for(;;){const e=l.read();if(null===e)return void(i=s._read);if(!s.push(e))return}}),s._destroy=function(e,t){e||null===o||(e=new Ps),i=null,r=null,n=null,null===o?t(e):(o=t,Is(l,e))},s},{pipeline:Ks}=Rs,{destroyer:Zs}=Li,Js=Bn,Xs=Fs,ea=pn,ta=re.exports=Yi.Stream;ta.isDisturbed=ea.isDisturbed,ta.isErrored=ea.isErrored,ta.isReadable=ea.isReadable,ta.Readable=Po();for(const ca of Gs(Qs)){const ha=Qs[ca];function da(...e){if(new.target)throw Hs();return ta.Readable.from(qs(ha,this,e))}Ws(da,"name",{__proto__:null,value:ha.name}),Ws(da,"length",{__proto__:null,value:ha.length}),Ws(ta.Readable.prototype,ca,{__proto__:null,value:da,enumerable:!1,configurable:!0,writable:!0})}for(const fa of Gs(Ys)){const pa=Ys[fa];function _a(...e){if(new.target)throw Hs();return qs(pa,this,e)}Ws(_a,"name",{__proto__:null,value:pa.name}),Ws(_a,"length",{__proto__:null,value:pa.length}),Ws(ta.Readable.prototype,fa,{__proto__:null,value:_a,enumerable:!1,configurable:!0,writable:!0})}ta.Writable=No(),ta.Duplex=Oo(),ta.Transform=$o,ta.PassThrough=Qo,ta.pipeline=Ks;const{addAbortSignal:ra}=Vi;ta.addAbortSignal=ra,ta.finished=Js,ta.destroy=Zs,ta.compose=Vs,Ws(ta,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>Xs}),Ws(Ks,zs,{__proto__:null,enumerable:!0,get:()=>Xs.pipeline}),Ws(Js,zs,{__proto__:null,enumerable:!0,get:()=>Xs.finished}),ta.Stream=ta,ta._isUint8Array=function(e){return e instanceof Uint8Array},ta._uint8ArrayToBuffer=function(e){return Us.from(e.buffer,e.byteOffset,e.byteLength)};var na=re.exports;!function(e){const t=na,r=Fs,n=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=n,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get:()=>r}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(te);var ia=te.exports;class oa{constructor(e,t){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._factory=t.factory||k,e&&this.addQuads(e)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let r,n;for(const i in t)for(const o in r=t[i].subjects)for(const t in n=r[o])e+=Object.keys(n[t]).length;return this._size=e}_addToIndex(e,t,r,n){const i=e[t]||(e[t]={}),o=i[r]||(i[r]={}),s=n in o;return s||(o[n]=null),!s}_removeFromIndex(e,t,r,n){const i=e[t],o=i[r];delete o[n];for(const e in o)return;delete i[r];for(const e in i)return;delete e[t]}*_findInIndex(e,t,r,n,i,o,s,a){let l,u,c;const h=this._entities,d=M(a,this._factory),f={subject:null,predicate:null,object:null};t&&((l=e,e={})[t]=l[t]);for(const t in e)if(u=e[t]){f[i]=M(h[t],this._factory),r&&((l=u,u={})[r]=l[r]);for(const e in u)if(c=u[e]){f[o]=M(h[e],this._factory);const t=n?n in c?[n]:[]:Object.keys(c);for(let e=0;e<t.length;e++)f[s]=M(h[t[e]],this._factory),yield this._factory.quad(f.subject,f.predicate,f.object,d)}}}_loop(e,t){for(const r in e)t(r)}_loopByKey0(e,t,r){let n,i;if(n=e[t])for(i in n)r(i)}_loopByKey1(e,t,r){let n,i;for(n in e)i=e[n],i[t]&&r(n)}_loopBy2Keys(e,t,r,n){let i,o,s;if((i=e[t])&&(o=i[r]))for(s in o)n(s)}_countInIndex(e,t,r,n){let i,o,s,a=0;t&&((i=e,e={})[t]=i[t]);for(const t in e)if(o=e[t]){r&&((i=o,o={})[r]=i[r]);for(const e in o)(s=o[e])&&(n?n in s&&a++:a+=Object.keys(s).length)}return a}_getGraphs(e){if(!sa(e))return this._graphs;const t={};return t[e]=this._graphs[e],t}_uniqueEntities(e){const t=Object.create(null);return r=>{r in t||(t[r]=!0,e(M(this._entities[r],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),e=D(e),t=D(t),r=D(r),n=D(n);let i=this._graphs[n];i||(i=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(i));const o=this._ids,s=this._entities;e=o[e]||(o[s[++this._id]=e]=this._id),t=o[t]||(o[s[++this._id]=t]=this._id),r=o[r]||(o[s[++this._id]=r]=this._id);const a=this._addToIndex(i.subjects,e,t,r);return this._addToIndex(i.predicates,t,r,e),this._addToIndex(i.objects,r,e,t),this._size=null,a}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}delete(e){return this.removeQuad(e),this}has(e,t,r,n){return e&&e.subject&&({subject:e,predicate:t,object:r,graph:n}=e),!this.readQuads(e,t,r,n).next().done}import(e){return e.on("data",(e=>{this.addQuad(e)})),e}removeQuad(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),e=D(e),t=D(t),r=D(r),n=D(n);const i=this._ids,o=this._graphs;let s,a,l;if(!((e=i[e])&&(t=i[t])&&(r=i[r])&&(s=o[n])&&(a=s.subjects[e])&&(l=a[t])&&r in l))return!1;for(e in this._removeFromIndex(s.subjects,e,t,r),this._removeFromIndex(s.predicates,t,r,e),this._removeFromIndex(s.objects,r,e,t),null!==this._size&&this._size--,s.subjects)return!0;return delete o[n],!0}removeQuads(e){for(let t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){return e.on("data",(e=>{this.removeQuad(e)})),e}removeMatches(e,t,r,n){const i=new ia.Readable({objectMode:!0});return i._read=()=>{for(const o of this.readQuads(e,t,r,n))i.push(o);i.push(null)},this.remove(i)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,t,r,n){return[...this.readQuads(e,t,r,n)]}*readQuads(e,t,r,n){e=e&&D(e),t=t&&D(t),r=r&&D(r),n=n&&D(n);const i=this._getGraphs(n),o=this._ids;let s,a,l,u;if(!(sa(e)&&!(a=o[e])||sa(t)&&!(l=o[t])||sa(r)&&!(u=o[r])))for(const e in i)(s=i[e])&&(a?u?yield*this._findInIndex(s.objects,u,a,l,"object","subject","predicate",e):yield*this._findInIndex(s.subjects,a,l,null,"subject","predicate","object",e):l?yield*this._findInIndex(s.predicates,l,u,null,"predicate","object","subject",e):u?yield*this._findInIndex(s.objects,u,null,null,"object","subject","predicate",e):yield*this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",e))}match(e,t,r,n){return new aa(this,e,t,r,n)}countQuads(e,t,r,n){e=e&&D(e),t=t&&D(t),r=r&&D(r),n=n&&D(n);const i=this._getGraphs(n),o=this._ids;let s,a,l,u,c=0;if(sa(e)&&!(a=o[e])||sa(t)&&!(l=o[t])||sa(r)&&!(u=o[r]))return 0;for(const n in i)(s=i[n])&&(c+=e?r?this._countInIndex(s.objects,u,a,l):this._countInIndex(s.subjects,a,l,u):t?this._countInIndex(s.predicates,l,u,a):this._countInIndex(s.objects,u,a,l));return c}forEach(e,t,r,n,i){this.some((t=>(e(t),!1)),t,r,n,i)}every(e,t,r,n,i){let o=!1;const s=!this.some((t=>(o=!0,!e(t))),t,r,n,i);return o&&s}some(e,t,r,n,i){for(const o of this.readQuads(t,r,n,i))if(e(o))return!0;return!1}getSubjects(e,t,r){const n=[];return this.forSubjects((e=>{n.push(e)}),e,t,r),n}forSubjects(e,t,r,n){t=t&&D(t),r=r&&D(r),n=n&&D(n);const i=this._ids,o=this._getGraphs(n);let s,a,l;if(e=this._uniqueEntities(e),!(sa(t)&&!(a=i[t])||sa(r)&&!(l=i[r])))for(n in o)(s=o[n])&&(a?l?this._loopBy2Keys(s.predicates,a,l,e):this._loopByKey1(s.subjects,a,e):l?this._loopByKey0(s.objects,l,e):this._loop(s.subjects,e))}getPredicates(e,t,r){const n=[];return this.forPredicates((e=>{n.push(e)}),e,t,r),n}forPredicates(e,t,r,n){t=t&&D(t),r=r&&D(r),n=n&&D(n);const i=this._ids,o=this._getGraphs(n);let s,a,l;if(e=this._uniqueEntities(e),!(sa(t)&&!(a=i[t])||sa(r)&&!(l=i[r])))for(n in o)(s=o[n])&&(a?l?this._loopBy2Keys(s.objects,l,a,e):this._loopByKey0(s.subjects,a,e):l?this._loopByKey1(s.predicates,l,e):this._loop(s.predicates,e))}getObjects(e,t,r){const n=[];return this.forObjects((e=>{n.push(e)}),e,t,r),n}forObjects(e,t,r,n){t=t&&D(t),r=r&&D(r),n=n&&D(n);const i=this._ids,o=this._getGraphs(n);let s,a,l;if(e=this._uniqueEntities(e),!(sa(t)&&!(a=i[t])||sa(r)&&!(l=i[r])))for(n in o)(s=o[n])&&(a?l?this._loopBy2Keys(s.subjects,a,l,e):this._loopByKey1(s.objects,a,e):l?this._loopByKey0(s.predicates,l,e):this._loop(s.objects,e))}getGraphs(e,t,r){const n=[];return this.forGraphs((e=>{n.push(e)}),e,t,r),n}forGraphs(e,t,r,n){for(const i in this._graphs)this.some((t=>(e(t.graph),!0)),t,r,n,i)}createBlankNode(e){let t,r;if(e)for(t=e=`_:${e}`,r=1;this._ids[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}extractLists({remove:e=!1,ignoreErrors:t=!1}={}){const r={},n=t?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},i=this.getQuads(null,l.rdf.rest,l.rdf.nil,null),o=e?[...i]:[];return i.forEach((t=>{const i=[];let s,a,u=!1;const c=t.graph;let h=t.subject;for(;h&&!u;){const e=this.getQuads(null,null,h,null),t=this.getQuads(h,null,null,null);let r,d=null,f=null,p=null;for(let i=0;i<t.length&&!u;i++)r=t[i],r.graph.equals(c)?s?u=n(h,"has non-list arcs out"):r.predicate.value===l.rdf.first?d?u=n(h,"has multiple rdf:first arcs"):o.push(d=r):r.predicate.value===l.rdf.rest?f?u=n(h,"has multiple rdf:rest arcs"):o.push(f=r):e.length?u=n(h,"can't be subject and object"):(s=r,a="subject"):u=n(h,"not confined to single graph");for(let t=0;t<e.length&&!u;++t)r=e[t],s?u=n(h,"can't have coreferences"):r.predicate.value===l.rdf.rest?p?u=n(h,"has incoming rdf:rest arcs"):p=r:(s=r,a="object");d?i.unshift(d.object):u=n(h,"has no list head"),h=p&&p.subject}u?e=!1:s&&(r[s[a].value]=i)})),e&&this.removeQuads(o),r}*[Symbol.iterator](){yield*this.readQuads()}}function sa(e){return"string"==typeof e||e instanceof String}class aa extends ia.Readable{constructor(e,t,r,n,i){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:t,predicate:r,object:n,graph:i})}get filtered(){if(!this._filtered){const{n3Store:e,graph:t,object:r,predicate:n,subject:i}=this,o=this._filtered=new oa({factory:e._factory});for(const s of e.readQuads(i,n,r,t))o.addQuad(s)}return this._filtered}get size(){return this.filtered.size}_read(){for(const e of this)this.push(e);this.push(null)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,t,r,n){return new aa(this.filtered,e,t,r,n)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}const{namedNode:la}=k;class ua{static async fetch(e){try{const t=await fetch(e,{headers:{Accept:"application/trig"}});return new ua({url:e,rdfString:await t.text()})}catch(t){return new ua({url:e,error:`⚠️ Issue fetching the nanopublication RDF at ${e}. ${t}`})}}static async parse(e,t=null){try{return new ua("string"==typeof e?{rdfString:e}:{store:e,prefixes:t})}catch(e){return new ua({error:`⚠️ Issue parsing the nanopublication RDF: ${e}`})}}constructor({url:e="",rdfString:t="",store:r=new oa,prefixes:n=null,error:i=""}){if(this.prefixes={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",prov:"http://www.w3.org/ns/prov#",npx:"http://purl.org/nanopub/x/",nschema:"http://www.nanopub.org/nschema#",orcid:"https://orcid.org/"},this.graphsId={head:"",assertion:"",provenance:"",pubinfo:""},this.displayNp={head:new Map,assertion:new Map,provenance:new Map,pubinfo:new Map},this.url=e,this.rdfString=t,this.store=r,this.error=i,n&&(this.prefixes=n),!this.error)if(!this.rdfString&&this.store.size<1)this.error='⚠️ No nanopublication has been provided, use the "url" or "rdfString"\n        attribute to provide the URL, or RDF in the TRiG format, of the nanopublication.';else{if(!this.rdfString&&this.store){const e=new J({prefixes:this.prefixes});e.addQuads(this.store.getQuads(null,null,null,null)),e.end(((e,t)=>{e?this.error=e.message:this.rdfString=t}))}if(this.store&&this.extractNanopubInfos(),this.rdfString&&this.store.size<1){(new W).parse(this.rdfString,((e,t,r)=>{if(e)return this.error=`⚠️ Issue parsing the nanopublication RDF with n3.js, make sure it is in the TRiG format. ${e}`,null;t?this.store.addQuad(t):(r.this&&r.sub?this.prefixes={this:r.this,sub:r.sub,...r}:this.prefixes=r,this.extractNanopubInfos())}))}}}getUri(e){const t=e.substring(0,e.indexOf(":"));return e.replace(`${t}:`,this.prefixes[t])}getCurie(e,t){if("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e)return"a";const r=this.prefixes.sub?{sub:this.prefixes.sub,...this.prefixes}:this.prefixes;if(t)return e.replace(r[t],`${t}:`);for(const t in r)if(e.startsWith(r[t]))return e.replace(r[t],`${t}:`);return e}extractNanopubInfos(){for(const e of this.store.match(null,la("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),la("http://www.nanopub.org/nschema#Nanopublication")))this.url||(this.url=e.subject.value.toString()),this.graphsId.head=this.getCurie(e.graph.value,"sub");for(const e of this.store.match(la(this.url),null,null))"http://www.nanopub.org/nschema#hasAssertion"===e.predicate.value&&(this.graphsId.assertion=this.getCurie(e.object.value,"sub")),"http://www.nanopub.org/nschema#hasProvenance"===e.predicate.value&&(this.graphsId.provenance=this.getCurie(e.object.value,"sub")),"http://www.nanopub.org/nschema#hasPublicationInfo"===e.predicate.value&&(this.graphsId.pubinfo=this.getCurie(e.object.value,"sub"));const e=["a","rdfs:label","rdfs:comment","rdf:subject","rdf:predicate","rdf:object"];for(const t of Object.keys(this.graphsId)){for(const e of this.store.match(null,null,null,la(this.getUri(this.graphsId[t])))){const r=this.getCurie(e.subject.value),n=this.getCurie(e.predicate.value);this.displayNp[t].has(r)||this.displayNp[t].set(r,new Map),this.displayNp[t].get(r).has(n)||this.displayNp[t].get(r).set(n,[]),this.displayNp[t].get(r).get(n).push({value:this.getCurie(e.object.value),type:e.object.termType})}this.displayNp[t]=new Map([...this.displayNp[t].entries()].sort(((e,t)=>e[0].startsWith("sub:")&&!t[0].startsWith("sub:")?-1:!e[0].startsWith("sub:")&&t[0].startsWith("sub:")?1:e[0].localeCompare(t[0]))));for(const[r,n]of this.displayNp[t].entries())this.displayNp[t].set(r,new Map([...n.entries()].sort(((t,r)=>-1!==e.indexOf(t[0])&&-1!==e.indexOf(r[0])?e.indexOf(t[0])-e.indexOf(r[0]):-1!==e.indexOf(t[0])&&-1===e.indexOf(r[0])?-1:-1===e.indexOf(t[0])&&-1!==e.indexOf(r[0])?1:t[0].localeCompare(r[0])))))}}}e.Nanopub=ua,e.getArtifactCode=i,e.getJson=(e,t)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="json",r.onload=function(){const e=r.status;t(200===e?null:e,r.response)},r.send()},e.getLatestNp=e=>{fetch("https://server.np.trustyuri.net/nanopubs.txt").then((e=>e.text())).then((t=>{const r=t.split(/\n/);e(r[r.length-2].trim())}))},e.getShortCode=e=>{const t=i(e);return null==t?null:t.substring(0,10)},e.getUpdateStatus=async e=>{const n=[...t].sort((()=>.5-Math.random()));return r(e,n)},e.grlcNpApiUrls=t,e.isTrustyUri=n}));
